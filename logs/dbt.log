

============================== 2022-12-02 04:08:48.331704 | 534d0e7b-5965-42f4-bfda-f8441c223cb5 ==============================
[0m04:08:48.331713 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:48.332333 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:08:48.332708 [debug] [MainThread]: Tracking: tracking
[0m04:08:48.344652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb638bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb638bb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb638bb100>]}
[0m04:08:48.452588 [debug] [MainThread]: Executing "git --help"
[0m04:08:48.455916 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:08:48.456457 [debug] [MainThread]: STDERR: "b''"
[0m04:08:48.457240 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m04:08:48.457732 [debug] [MainThread]: Using redshift connection "debug"
[0m04:08:48.458192 [debug] [MainThread]: On debug: select 1 as id
[0m04:08:48.458705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:48.459234 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:08:49.659655 [debug] [MainThread]: SQL status: SELECT in 1.2 seconds
[0m04:08:49.662293 [debug] [MainThread]: On debug: Close
[0m04:08:49.663673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61c1cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61c39310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61c398e0>]}
[0m04:08:49.664729 [debug] [MainThread]: Flushing usage events
[0m04:08:50.428429 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-03 03:58:18.180826 | 8186f447-8efd-46f6-968f-221a52268a22 ==============================
[0m03:58:18.180838 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:58:18.181673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:58:18.182195 [debug] [MainThread]: Tracking: tracking
[0m03:58:18.193132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1eadd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1eadd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1eadd1c0>]}
[0m03:58:18.356034 [debug] [MainThread]: Executing "git --help"
[0m03:58:18.367423 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:58:18.368035 [debug] [MainThread]: STDERR: "b''"
[0m03:58:18.368854 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m03:58:18.369262 [debug] [MainThread]: Using redshift connection "debug"
[0m03:58:18.369739 [debug] [MainThread]: On debug: select 1 as id
[0m03:58:18.370356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:58:18.371094 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m03:58:20.066024 [debug] [MainThread]: SQL status: SELECT in 1.7 seconds
[0m03:58:20.068856 [debug] [MainThread]: On debug: Close
[0m03:58:20.070390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1ce3daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1ce5e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1ce5e820>]}
[0m03:58:20.071745 [debug] [MainThread]: Flushing usage events
[0m03:58:20.783838 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-03 04:04:05.098572 | 5dccf158-cee3-43a9-8d6d-c488ccf4448a ==============================
[0m04:04:05.098586 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:04:05.099131 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:04:05.099647 [debug] [MainThread]: Tracking: tracking
[0m04:04:05.106628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1fac0>]}
[0m04:04:05.128811 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m04:04:05.129764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19cbef70>]}
[0m04:04:05.239761 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:04:05.242088 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:04:05.258973 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:04:05.267886 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:04:05.268848 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:04:05.269600 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:04:05.270178 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:05.272593 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:04:05.273185 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:05.274049 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:05.274671 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:05.275246 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:04:05.276320 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:05.277147 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:04:05.277645 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:04:05.278552 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:04:05.279571 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:04:05.281008 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:04:05.296191 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:04:05.298203 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:04:05.299490 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:04:05.301083 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:04:05.302466 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:05.303678 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:05.304567 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:05.308853 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:04:05.309424 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:05.310028 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:05.311043 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:04:05.315429 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:04:05.321964 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:04:05.331597 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:04:05.335545 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:04:05.337228 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:04:05.346225 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:04:05.349971 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:04:05.351997 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:04:05.353596 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:04:05.358305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:04:05.360096 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:04:05.361304 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:04:05.363093 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:04:05.369048 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:04:05.372664 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:04:05.373333 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:04:05.374023 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:04:05.374784 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:04:05.375893 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:04:05.377562 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:04:05.381256 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:04:05.383031 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:04:05.384390 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:04:05.387459 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:04:05.399270 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:04:05.403913 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:04:05.405217 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:04:05.412741 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:04:05.423654 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:04:05.432121 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:04:05.442693 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:04:05.452160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:04:05.458919 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:04:05.463485 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:04:05.464683 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:04:05.469954 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:04:05.472285 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:04:05.473360 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:04:05.476930 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:04:05.478632 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:04:05.481325 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:04:05.485130 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:05.487132 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:04:05.488051 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:05.489547 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:04:05.490360 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:05.491358 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:04:05.492221 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:04:05.493026 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:04:05.493824 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:05.494778 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:04:05.496227 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:04:05.497303 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:05.498722 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:04:05.499721 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:04:05.500590 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:04:05.501444 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:04:05.502264 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:04:05.503168 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:04:05.504156 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:04:05.505040 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:04:05.509428 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:04:05.510202 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:04:05.511432 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:04:05.512365 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:04:05.513495 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:04:05.697307 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:04:05.706311 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:04:05.770688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18149ac0>]}
[0m04:04:05.789783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d08910>]}
[0m04:04:05.790239 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:04:05.790678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1814cf70>]}
[0m04:04:05.792001 [info ] [MainThread]: 
[0m04:04:05.792940 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:04:05.794288 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:04:05.805716 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:04:05.806339 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:04:05.806828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:04:05.807229 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:07.379643 [debug] [ThreadPool]: SQL status: SELECT in 1.57 seconds
[0m04:04:07.381775 [debug] [ThreadPool]: On list_dev: Close
[0m04:04:07.384348 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:04:07.423620 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:04:07.423961 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:04:07.424321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:07.424666 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:08.751985 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
[0m04:04:08.752797 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:04:08.753342 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:04:08.894637 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
[0m04:04:08.896351 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:04:09.005566 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:04:09.011824 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:09.012555 [debug] [MainThread]: On master: BEGIN
[0m04:04:09.013143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:04:09.013624 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:10.276355 [debug] [MainThread]: SQL status: BEGIN in 1.26 seconds
[0m04:04:10.277439 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:10.278337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:04:10.439423 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m04:04:10.442392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18132be0>]}
[0m04:04:10.443569 [debug] [MainThread]: On master: ROLLBACK
[0m04:04:10.583065 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:10.584047 [debug] [MainThread]: On master: BEGIN
[0m04:04:11.088668 [debug] [MainThread]: SQL status: BEGIN in 0.5 seconds
[0m04:04:11.089954 [debug] [MainThread]: On master: COMMIT
[0m04:04:11.091112 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:11.092202 [debug] [MainThread]: On master: COMMIT
[0m04:04:11.252814 [debug] [MainThread]: SQL status: COMMIT in 0.16 seconds
[0m04:04:11.253394 [debug] [MainThread]: On master: Close
[0m04:04:11.254382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:04:11.254863 [info ] [MainThread]: 
[0m04:04:11.266599 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:04:11.267445 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:04:11.268334 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.268806 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:04:11.269196 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:04:11.272216 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.291718 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:11.292079 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:04:11.333338 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.341823 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.342041 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:04:11.342235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:04:11.342446 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:12.838143 [debug] [Thread-1  ]: SQL status: BEGIN in 1.5 seconds
[0m04:04:12.839408 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:12.840564 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:04:13.444219 [debug] [Thread-1  ]: SQL status: SELECT in 0.6 seconds
[0m04:04:13.450892 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.451699 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:04:13.576611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:04:13.592328 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:13.593067 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.593833 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:13.781770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m04:04:13.782602 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.782989 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:04:13.905186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:04:13.912581 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.913642 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:04:14.033423 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m04:04:14.034788 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:14.035235 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:14.035791 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:14.160962 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m04:04:14.161874 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:14.162492 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:04:14.359369 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
[0m04:04:14.361120 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:14.362116 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:04:14.482500 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:04:14.484829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18175d30>]}
[0m04:04:14.486304 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 3.22s]
[0m04:04:14.487648 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:04:14.489770 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:04:14.491375 [info ] [Thread-1  ]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:04:14.494812 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.495481 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:04:14.496108 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:04:14.499859 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.509303 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:14.509652 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:04:14.530518 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.540824 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.541110 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:04:14.541467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:04:14.541796 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:15.524118 [debug] [Thread-1  ]: SQL status: BEGIN in 0.98 seconds
[0m04:04:15.524981 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:15.525711 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:04:15.703128 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.18 seconds
[0m04:04:15.706010 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:15.706567 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:04:15.815256 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:04:15.818128 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:15.818822 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:15.819416 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:16.018065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:04:16.019616 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.020714 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:04:16.214442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m04:04:16.216750 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.217277 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:04:16.422370 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:04:16.424626 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:16.425450 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.426297 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:16.625949 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:04:16.627060 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.628079 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:04:16.743770 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:04:16.745056 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:16.745888 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:04:16.886133 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:04:16.887414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18175d30>]}
[0m04:04:16.888081 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.39s]
[0m04:04:16.888920 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:04:16.890574 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:04:16.891104 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:16.891567 [debug] [MainThread]: On master: BEGIN
[0m04:04:16.891994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:04:16.892296 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:18.113275 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
[0m04:04:18.114501 [debug] [MainThread]: On master: COMMIT
[0m04:04:18.115639 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:18.116576 [debug] [MainThread]: On master: COMMIT
[0m04:04:18.266067 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
[0m04:04:18.267354 [debug] [MainThread]: On master: Close
[0m04:04:18.269327 [info ] [MainThread]: 
[0m04:04:18.270512 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.48 seconds (12.48s).
[0m04:04:18.271541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:04:18.272213 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:04:18.289873 [info ] [MainThread]: 
[0m04:04:18.290304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:04:18.290838 [info ] [MainThread]: 
[0m04:04:18.291360 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:04:18.292124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19bb30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19bfcbb0>]}
[0m04:04:18.292831 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:24:38.832067 | 8c31e550-dd34-4acb-93a7-008d380ff25f ==============================
[0m04:24:38.832078 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:24:38.832510 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['views/vw_sales.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:24:38.832722 [debug] [MainThread]: Tracking: tracking
[0m04:24:38.839957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c4a00>]}
[0m04:24:38.869927 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:24:38.870366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3a4040>]}
[0m04:24:38.936541 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:24:38.938390 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:24:38.954818 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:24:38.963033 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:24:38.963645 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:24:38.964252 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:24:38.964887 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:24:38.967180 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:24:38.967818 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:24:38.968701 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:24:38.969334 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:24:38.969972 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:24:38.970524 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:24:38.971310 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:24:38.971828 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:24:38.972396 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:24:38.972963 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:24:38.974314 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:24:38.988859 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:24:38.990514 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:24:38.991548 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:24:38.992767 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:24:38.993622 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:24:38.994724 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:24:38.995594 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:24:38.999774 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:24:39.000308 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:24:39.000892 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:24:39.001907 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:24:39.006115 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:24:39.012211 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:24:39.021004 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:24:39.024413 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:24:39.026989 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:24:39.037431 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:24:39.040911 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:24:39.044021 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:24:39.046389 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:24:39.053261 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:24:39.056292 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:24:39.058247 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:24:39.060296 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:24:39.066518 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:24:39.070388 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:24:39.071311 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:24:39.072298 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:24:39.073350 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:24:39.074741 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:24:39.076613 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:24:39.079644 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:24:39.081224 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:24:39.083109 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:24:39.086706 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:24:39.098091 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:24:39.104426 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:24:39.106510 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:24:39.114957 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:24:39.126943 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:24:39.136319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:24:39.148687 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:24:39.158813 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:24:39.165775 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:24:39.172614 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:24:39.174627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:24:39.181726 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:24:39.184762 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:24:39.186470 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:24:39.192218 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:24:39.194761 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:24:39.198104 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:24:39.202221 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:24:39.204984 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:24:39.206493 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:24:39.209148 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:24:39.210672 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:24:39.212442 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:24:39.213958 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:24:39.215461 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:24:39.216940 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:24:39.218825 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:24:39.220425 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:24:39.222276 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:24:39.224071 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:24:39.225537 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:24:39.227025 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:24:39.228721 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:24:39.230272 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:24:39.232031 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:24:39.233668 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:24:39.235318 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:24:39.241405 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:24:39.242751 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:24:39.244787 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:24:39.246235 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:24:39.247843 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:24:39.426157 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:24:39.436373 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:24:39.439718 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:24:39.522888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c33cc40>]}
[0m04:24:39.538953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c355460>]}
[0m04:24:39.539335 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:24:39.539804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa349982f10>]}
[0m04:24:39.541275 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m04:24:39.542211 [info ] [MainThread]: 
[0m04:24:39.542554 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:24:39.555441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c35fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c32c160>]}
[0m04:24:39.555929 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:25:36.078293 | a37110cd-2b77-4836-bf24-2d4e37355891 ==============================
[0m04:25:36.078305 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:25:36.078876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:25:36.079349 [debug] [MainThread]: Tracking: tracking
[0m04:25:36.086405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d50109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5010a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5010ac0>]}
[0m04:25:36.257866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:25:36.258335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:25:36.263233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4f0db20>]}
[0m04:25:36.277175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4fac400>]}
[0m04:25:36.277633 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:25:36.278279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4fac700>]}
[0m04:25:36.279604 [info ] [MainThread]: 
[0m04:25:36.280460 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:25:36.282237 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:25:36.294005 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:25:36.294624 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:25:36.295305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:36.295938 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:37.690470 [debug] [ThreadPool]: SQL status: SELECT in 1.4 seconds
[0m04:25:37.692064 [debug] [ThreadPool]: On list_dev: Close
[0m04:25:37.694158 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:25:37.699709 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:25:37.700163 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:25:37.700478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:37.700712 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:38.899615 [debug] [ThreadPool]: SQL status: BEGIN in 1.2 seconds
[0m04:25:38.900804 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:25:38.901767 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:25:39.032234 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m04:25:39.034142 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:25:39.150021 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:25:39.154544 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:39.154989 [debug] [MainThread]: On master: BEGIN
[0m04:25:39.155494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:25:39.155989 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:40.267220 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m04:25:40.267903 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:40.268437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:25:40.430298 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m04:25:40.432056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4ed63d0>]}
[0m04:25:40.432836 [debug] [MainThread]: On master: ROLLBACK
[0m04:25:40.550623 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:40.551304 [debug] [MainThread]: On master: BEGIN
[0m04:25:40.836175 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
[0m04:25:40.837449 [debug] [MainThread]: On master: COMMIT
[0m04:25:40.838510 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:40.839460 [debug] [MainThread]: On master: COMMIT
[0m04:25:41.050006 [debug] [MainThread]: SQL status: COMMIT in 0.21 seconds
[0m04:25:41.050671 [debug] [MainThread]: On master: Close
[0m04:25:41.051635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:25:41.052185 [info ] [MainThread]: 
[0m04:25:41.055361 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:25:41.056138 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:25:41.057187 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.057561 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:25:41.058032 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:25:41.061480 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.071285 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:41.071683 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:25:41.108108 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.121797 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.122215 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:25:41.122521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:41.122828 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:42.533824 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m04:25:42.534447 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:42.534942 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:25:42.706425 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m04:25:42.717520 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:42.718193 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:25:42.847419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:25:42.853990 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:42.854828 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:25:42.996675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m04:25:43.025985 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.026716 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.027279 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.220274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m04:25:43.221843 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.222773 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:25:43.409365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m04:25:43.418010 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.418623 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:25:43.551742 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m04:25:43.554317 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.555347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.556180 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.714781 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:25:43.715944 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.717017 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:25:43.845513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:25:43.846950 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:43.847676 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:25:43.975770 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:25:43.978121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d45cb910>]}
[0m04:25:43.979466 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.92s]
[0m04:25:43.980912 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:25:43.982001 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:25:43.983471 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:25:43.985294 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:25:43.985966 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:25:43.986614 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:25:43.989132 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:25:44.004259 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:44.004667 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:25:44.024337 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:25:44.040917 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:25:44.041356 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:25:44.041663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:44.041946 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:45.325441 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m04:25:45.326670 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:25:45.327800 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PREICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA

    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:25:45.458155 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "preicepaid" does not exist in source_sales

[0m04:25:45.458992 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:25:45.586731 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:45.588017 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:25:45.590135 [debug] [Thread-1  ]: Database Error in model vw_sales (models/views/vw_sales.sql)
  column "preicepaid" does not exist in source_sales
  compiled Code at target/run/analytics_dbt/models/views/vw_sales.sql
[0m04:25:45.591335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4600670>]}
[0m04:25:45.592699 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.61s]
[0m04:25:45.594179 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:25:45.595358 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:25:45.596279 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:25:45.597632 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.598175 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:25:45.598721 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:25:45.602624 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.614477 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:45.614971 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:25:45.618257 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.624749 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.625027 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:25:45.625255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:45.625608 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:47.037532 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m04:25:47.038939 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.040081 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:25:47.164845 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:25:47.170478 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.171187 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:25:47.294620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:25:47.299490 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:47.300490 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.301186 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:47.447165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:25:47.448017 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.448351 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:25:47.607056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m04:25:47.611932 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.612875 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:25:47.812435 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:25:47.815031 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:47.816126 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.817211 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:48.014654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:25:48.015878 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:48.016966 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:25:48.139313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:25:48.141138 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:48.142263 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:25:48.324597 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:25:48.326939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4568c40>]}
[0m04:25:48.328399 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.73s]
[0m04:25:48.329896 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:25:48.333771 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:25:48.334671 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:48.335560 [debug] [MainThread]: On master: BEGIN
[0m04:25:48.336316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:25:48.337026 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:49.559665 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
[0m04:25:49.560869 [debug] [MainThread]: On master: COMMIT
[0m04:25:49.561618 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:49.562292 [debug] [MainThread]: On master: COMMIT
[0m04:25:49.756850 [debug] [MainThread]: SQL status: COMMIT in 0.19 seconds
[0m04:25:49.757966 [debug] [MainThread]: On master: Close
[0m04:25:49.760012 [info ] [MainThread]: 
[0m04:25:49.761114 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.48 seconds (13.48s).
[0m04:25:49.762153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:49.762970 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:25:49.786717 [info ] [MainThread]: 
[0m04:25:49.787103 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:25:49.787616 [info ] [MainThread]: 
[0m04:25:49.788031 [error] [MainThread]: [33mDatabase Error in model vw_sales (models/views/vw_sales.sql)[0m
[0m04:25:49.788724 [error] [MainThread]:   column "preicepaid" does not exist in source_sales
[0m04:25:49.789173 [error] [MainThread]:   compiled Code at target/run/analytics_dbt/models/views/vw_sales.sql
[0m04:25:49.789596 [info ] [MainThread]: 
[0m04:25:49.790030 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m04:25:49.790571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d460c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d45162b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4516670>]}
[0m04:25:49.791272 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:26:08.249693 | 3aec6885-fb2f-48ac-8953-de7959f83641 ==============================
[0m04:26:08.249705 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:26:08.250156 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:26:08.250739 [debug] [MainThread]: Tracking: tracking
[0m04:26:08.257522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc822baac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc822bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc822babb0>]}
[0m04:26:08.370653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:26:08.371140 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:26:08.382252 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:26:08.408413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc821783a0>]}
[0m04:26:08.425211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc82197f10>]}
[0m04:26:08.425582 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:26:08.426110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8213e640>]}
[0m04:26:08.427577 [info ] [MainThread]: 
[0m04:26:08.428686 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:26:08.430064 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:26:08.440224 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:26:08.440696 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:26:08.441056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:08.441283 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:09.564258 [debug] [ThreadPool]: SQL status: SELECT in 1.12 seconds
[0m04:26:09.567893 [debug] [ThreadPool]: On list_dev: Close
[0m04:26:09.572445 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:26:09.582839 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:26:09.583356 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:26:09.583852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:26:09.584381 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:11.172793 [debug] [ThreadPool]: SQL status: BEGIN in 1.59 seconds
[0m04:26:11.173469 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:26:11.173969 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:26:11.385460 [debug] [ThreadPool]: SQL status: SELECT in 0.21 seconds
[0m04:26:11.388221 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:26:11.568516 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:26:11.574049 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:11.574386 [debug] [MainThread]: On master: BEGIN
[0m04:26:11.574633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:26:11.574978 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:12.914488 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
[0m04:26:12.915889 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:12.917181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:26:13.087940 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
[0m04:26:13.091782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc82178550>]}
[0m04:26:13.093031 [debug] [MainThread]: On master: ROLLBACK
[0m04:26:13.224763 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:13.225961 [debug] [MainThread]: On master: BEGIN
[0m04:26:13.541304 [debug] [MainThread]: SQL status: BEGIN in 0.31 seconds
[0m04:26:13.542390 [debug] [MainThread]: On master: COMMIT
[0m04:26:13.543153 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:13.543983 [debug] [MainThread]: On master: COMMIT
[0m04:26:13.675163 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m04:26:13.676525 [debug] [MainThread]: On master: Close
[0m04:26:13.678580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:26:13.679842 [info ] [MainThread]: 
[0m04:26:13.684689 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:26:13.685270 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:26:13.686215 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.686668 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:26:13.687164 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:26:13.689986 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.701320 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:13.701769 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:26:13.736411 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.742640 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.742832 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:26:13.743018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:13.743201 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:14.846563 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m04:26:14.847630 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:14.848512 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:26:15.002671 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m04:26:15.008198 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.008846 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:26:15.148029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m04:26:15.151075 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.151623 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:26:15.263611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:26:15.281757 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.282452 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.283157 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.432692 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:26:15.433568 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.434145 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:26:15.544493 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:26:15.548879 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.549484 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:26:15.663999 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.11 seconds
[0m04:26:15.665717 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.666264 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.666698 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.875178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.21 seconds
[0m04:26:15.876473 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.877541 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:26:15.989182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:26:15.990277 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:15.991033 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:26:16.177587 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:26:16.179126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8007a850>]}
[0m04:26:16.180018 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.49s]
[0m04:26:16.181078 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:26:16.181786 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:26:16.182516 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:26:16.183461 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:16.183884 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:26:16.184410 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:26:16.186784 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:26:16.197738 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:16.198163 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:26:16.218415 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:26:16.224811 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:16.225055 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:26:16.225378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:16.225789 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:17.515472 [debug] [Thread-1  ]: SQL status: BEGIN in 1.29 seconds
[0m04:26:17.516163 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.516615 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA

    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:26:17.646273 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m04:26:17.652066 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.652872 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:26:17.778655 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:26:17.782910 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:17.784104 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.785072 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:17.942328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:26:17.943931 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.944923 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:26:18.092875 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:26:18.097679 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:18.098774 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:26:18.224574 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m04:26:18.227103 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:18.228168 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:18.229132 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:18.379253 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:26:18.380028 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:18.380599 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:26:18.505264 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:26:18.507187 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:18.508235 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:26:18.668866 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:26:18.671346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc517bff70>]}
[0m04:26:18.673037 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.49s]
[0m04:26:18.674499 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:26:18.675622 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:26:18.676741 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:26:18.678284 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.678854 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:26:18.679447 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:26:18.685272 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.695241 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:18.695817 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:26:18.700881 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.708340 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.708646 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:26:18.708895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:18.709178 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:20.065976 [debug] [Thread-1  ]: SQL status: BEGIN in 1.36 seconds
[0m04:26:20.067110 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.067951 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:26:20.272550 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m04:26:20.277065 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.277820 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:26:20.476159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.2 seconds
[0m04:26:20.477949 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:20.478470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.478899 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:20.726141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.25 seconds
[0m04:26:20.727590 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.728470 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:26:20.889049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m04:26:20.892194 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.892769 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:26:21.089718 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:26:21.090914 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:21.091369 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:21.091791 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:21.246935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:26:21.247772 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:21.248410 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:26:21.374948 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:26:21.376392 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:21.377221 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:26:21.506143 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:26:21.508654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc800ebf40>]}
[0m04:26:21.509963 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.83s]
[0m04:26:21.511350 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:26:21.514385 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:26:21.514928 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:21.515399 [debug] [MainThread]: On master: BEGIN
[0m04:26:21.515848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:26:21.516328 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:22.864153 [debug] [MainThread]: SQL status: BEGIN in 1.35 seconds
[0m04:26:22.865408 [debug] [MainThread]: On master: COMMIT
[0m04:26:22.866604 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:22.867553 [debug] [MainThread]: On master: COMMIT
[0m04:26:23.036600 [debug] [MainThread]: SQL status: COMMIT in 0.17 seconds
[0m04:26:23.037973 [debug] [MainThread]: On master: Close
[0m04:26:23.040104 [info ] [MainThread]: 
[0m04:26:23.041418 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.61 seconds (14.61s).
[0m04:26:23.042532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:26:23.043290 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:26:23.070423 [info ] [MainThread]: 
[0m04:26:23.071111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:26:23.071674 [info ] [MainThread]: 
[0m04:26:23.072164 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:26:23.072892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc868f1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc51783ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc517837c0>]}
[0m04:26:23.073362 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:30:35.727310 | 27bf8dda-e5c7-4c0d-ad49-0b8826d72309 ==============================
[0m04:30:35.727324 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:30:35.727914 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:30:35.728336 [debug] [MainThread]: Tracking: tracking
[0m04:30:35.735293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d6c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d6c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d6ca00>]}
[0m04:30:35.875897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:30:35.876351 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:30:35.888713 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:30:35.915374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550c721f0>]}
[0m04:30:35.927426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550c49d60>]}
[0m04:30:35.927907 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:30:35.928533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550bf24c0>]}
[0m04:30:35.930149 [info ] [MainThread]: 
[0m04:30:35.931133 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:30:35.932285 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:30:35.941319 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:30:35.941645 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:30:35.941887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:35.942095 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:37.122737 [debug] [ThreadPool]: SQL status: SELECT in 1.18 seconds
[0m04:30:37.126335 [debug] [ThreadPool]: On list_dev: Close
[0m04:30:37.130923 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:30:37.141588 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:30:37.142089 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:30:37.142594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:37.143172 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:38.280511 [debug] [ThreadPool]: SQL status: BEGIN in 1.14 seconds
[0m04:30:38.281258 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:30:38.281858 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:30:38.406218 [debug] [ThreadPool]: SQL status: SELECT in 0.12 seconds
[0m04:30:38.409765 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:30:38.525994 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:30:38.531015 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:38.531723 [debug] [MainThread]: On master: BEGIN
[0m04:30:38.532231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:30:38.532575 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:39.678279 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m04:30:39.679269 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:39.680098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:30:39.827505 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m04:30:39.830661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d16430>]}
[0m04:30:39.831934 [debug] [MainThread]: On master: ROLLBACK
[0m04:30:39.962074 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:39.963281 [debug] [MainThread]: On master: BEGIN
[0m04:30:40.223967 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
[0m04:30:40.225019 [debug] [MainThread]: On master: COMMIT
[0m04:30:40.225849 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:40.226625 [debug] [MainThread]: On master: COMMIT
[0m04:30:40.335551 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m04:30:40.336829 [debug] [MainThread]: On master: Close
[0m04:30:40.338911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:30:40.340153 [info ] [MainThread]: 
[0m04:30:40.346890 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:30:40.347695 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:30:40.348782 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.349161 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:30:40.349720 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:30:40.353819 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.367994 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:40.368471 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:30:40.403638 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.412030 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.412474 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:30:40.412710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:30:40.412935 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:41.853779 [debug] [Thread-1  ]: SQL status: BEGIN in 1.44 seconds
[0m04:30:41.855084 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:41.856099 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:30:42.025991 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m04:30:42.036677 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.037444 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:30:42.178005 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m04:30:42.183884 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.184629 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:30:42.341250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m04:30:42.367872 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.368827 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.369356 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.531767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:30:42.532511 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.532767 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:30:42.647493 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:30:42.657515 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.658230 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:30:42.774506 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m04:30:42.775899 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.776653 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.777211 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.931895 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:30:42.932966 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.933570 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:30:43.080693 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:30:43.082750 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:43.083873 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:30:43.198552 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:30:43.199941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55013ed00>]}
[0m04:30:43.200772 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.85s]
[0m04:30:43.201796 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:30:43.202227 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:30:43.202731 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:30:43.203876 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:43.204381 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:30:43.204912 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:30:43.207069 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:30:43.217885 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:43.218309 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:30:43.234293 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:30:43.240652 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:43.240848 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:30:43.241185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:30:43.241705 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:44.237897 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m04:30:44.239125 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.240047 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA

    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:30:44.356049 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:30:44.362923 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.363827 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:30:44.569607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.21 seconds
[0m04:30:44.574347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.575291 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:30:44.776376 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.2 seconds
[0m04:30:44.779391 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:44.780234 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.781062 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:44.926219 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:30:44.927330 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.928110 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:30:45.038170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:30:45.040169 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:45.040622 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:30:45.151680 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.11 seconds
[0m04:30:45.152925 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:45.153345 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:45.153807 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:45.395527 [debug] [Thread-1  ]: SQL status: COMMIT in 0.24 seconds
[0m04:30:45.396581 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:45.397429 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:30:45.547819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:30:45.549687 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:45.550787 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:30:45.671575 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:30:45.673990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5500a21c0>]}
[0m04:30:45.675491 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.47s]
[0m04:30:45.677099 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:30:45.678071 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:30:45.679105 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:30:45.681082 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.681646 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:30:45.682323 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:30:45.686480 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.697233 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:45.697951 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:30:45.701498 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.708944 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.709166 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:30:45.709399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:30:45.709616 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:46.994266 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m04:30:46.995493 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:46.996380 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:30:47.124738 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m04:30:47.130744 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.131536 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:30:47.263363 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:30:47.265926 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.266569 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.267204 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.418132 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:30:47.419029 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.419624 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:30:47.544000 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:30:47.546088 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.546605 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:30:47.725401 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:30:47.728119 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.729115 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.730071 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.882135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:30:47.883264 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.884583 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:30:48.051800 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m04:30:48.053612 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:48.054596 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:30:48.258716 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:30:48.260569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501a27f0>]}
[0m04:30:48.261962 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.58s]
[0m04:30:48.262937 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:30:48.265041 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:30:48.265553 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:48.265995 [debug] [MainThread]: On master: BEGIN
[0m04:30:48.266420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:30:48.266873 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:49.412195 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m04:30:49.413118 [debug] [MainThread]: On master: COMMIT
[0m04:30:49.413705 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:49.414209 [debug] [MainThread]: On master: COMMIT
[0m04:30:49.530103 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:30:49.531080 [debug] [MainThread]: On master: Close
[0m04:30:49.532458 [info ] [MainThread]: 
[0m04:30:49.533251 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m04:30:49.533958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:49.534619 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:30:49.557196 [info ] [MainThread]: 
[0m04:30:49.557694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:30:49.558370 [info ] [MainThread]: 
[0m04:30:49.558914 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:30:49.559706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501b0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501b0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501ac850>]}
[0m04:30:49.560405 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:31:23.816354 | f30b64c3-5486-4c7e-ac6c-50b95a02bce8 ==============================
[0m04:31:23.816366 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:31:23.817105 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:31:23.817661 [debug] [MainThread]: Tracking: tracking
[0m04:31:23.824403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307cb10a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307cb10ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307cb10af0>]}
[0m04:31:23.939011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:31:23.939499 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:31:23.950910 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:31:23.975964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c94e2e0>]}
[0m04:31:23.987222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c96ee50>]}
[0m04:31:23.987512 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:31:23.987785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c9d65b0>]}
[0m04:31:23.989064 [info ] [MainThread]: 
[0m04:31:23.989738 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:31:23.991132 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:31:24.002068 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:31:24.002508 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:31:24.002719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:24.002916 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:25.039623 [debug] [ThreadPool]: SQL status: SELECT in 1.04 seconds
[0m04:31:25.043224 [debug] [ThreadPool]: On list_dev: Close
[0m04:31:25.046828 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:31:25.056527 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:31:25.057165 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:31:25.057749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:25.058333 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:26.452162 [debug] [ThreadPool]: SQL status: BEGIN in 1.39 seconds
[0m04:31:26.453250 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:31:26.454053 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:31:26.605428 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
[0m04:31:26.608745 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:31:26.728416 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:31:26.738389 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:26.739018 [debug] [MainThread]: On master: BEGIN
[0m04:31:26.739596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:26.740289 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:27.814336 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m04:31:27.815669 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:27.816810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:31:27.966653 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m04:31:27.970083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c94e730>]}
[0m04:31:27.971412 [debug] [MainThread]: On master: ROLLBACK
[0m04:31:28.081657 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:28.082805 [debug] [MainThread]: On master: BEGIN
[0m04:31:28.303067 [debug] [MainThread]: SQL status: BEGIN in 0.22 seconds
[0m04:31:28.303763 [debug] [MainThread]: On master: COMMIT
[0m04:31:28.304259 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:28.304748 [debug] [MainThread]: On master: COMMIT
[0m04:31:28.502175 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m04:31:28.503263 [debug] [MainThread]: On master: Close
[0m04:31:28.504982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:31:28.505950 [info ] [MainThread]: 
[0m04:31:28.512085 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:31:28.512767 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:31:28.513737 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.514112 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:31:28.514605 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:31:28.518106 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.527797 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:28.528223 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:31:28.564708 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.574165 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.574468 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:31:28.574670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:31:28.574910 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:29.705675 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m04:31:29.706540 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:29.707381 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:31:29.869964 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m04:31:29.879534 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:29.880154 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:31:30.030313 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
[0m04:31:30.036168 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.036828 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:31:30.148043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:31:30.174900 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.175716 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.176614 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.331426 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:31:30.332547 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.333052 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:31:30.443286 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:31:30.447898 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.448496 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:31:30.560620 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.11 seconds
[0m04:31:30.563321 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.564360 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.565331 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.707190 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:31:30.707978 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.708632 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:31:30.855819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:31:30.857644 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:30.858594 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:31:31.060807 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:31:31.063176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c09d8e0>]}
[0m04:31:31.064737 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.55s]
[0m04:31:31.066509 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:31:31.067769 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:31:31.068962 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:31:31.070677 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:31.071209 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:31:31.071774 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:31:31.074044 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:31:31.084694 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:31.085186 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:31:31.105877 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:31:31.115649 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:31.116307 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:31:31.117090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:31:31.117705 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:32.393863 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m04:31:32.394886 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.395525 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA,
        cast(saletime as date) as DATA_VENDA
    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:31:32.597875 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m04:31:32.604531 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.605337 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:31:32.802440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.2 seconds
[0m04:31:32.808034 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.808914 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:31:32.938204 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:31:32.943008 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:32.944121 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.944888 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:33.098159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:31:33.099118 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.099714 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:31:33.229004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:31:33.231201 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.231870 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:31:33.407868 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:31:33.409607 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:33.410138 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.410701 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:33.578374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m04:31:33.579450 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.580239 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:31:33.732880 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:31:33.733951 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:33.734414 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:31:33.861390 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:31:33.864147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c005af0>]}
[0m04:31:33.865794 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.79s]
[0m04:31:33.867528 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:31:33.868777 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:31:33.869966 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:31:33.872261 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.873060 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:31:33.874049 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:31:33.878787 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.888798 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:33.889230 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:31:33.892466 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.902401 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.902749 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:31:33.902963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:31:33.903308 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:35.395586 [debug] [Thread-1  ]: SQL status: BEGIN in 1.49 seconds
[0m04:31:35.396706 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.397642 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:31:35.523754 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m04:31:35.526656 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.527204 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:31:35.647006 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:31:35.650787 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:35.651701 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.652489 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:35.797855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:31:35.799347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.800443 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:31:35.975894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m04:31:35.980973 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.981902 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:31:36.161710 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:31:36.162966 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:36.163542 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:36.164190 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:36.386610 [debug] [Thread-1  ]: SQL status: COMMIT in 0.22 seconds
[0m04:31:36.387237 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:36.387903 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:31:36.506124 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:31:36.507828 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:36.508858 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:31:36.627484 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:31:36.629123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c1029d0>]}
[0m04:31:36.629949 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.76s]
[0m04:31:36.630881 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:31:36.633948 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:31:36.634825 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:36.635192 [debug] [MainThread]: On master: BEGIN
[0m04:31:36.635554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:36.635908 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:37.975589 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
[0m04:31:37.976871 [debug] [MainThread]: On master: COMMIT
[0m04:31:37.977746 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:37.978650 [debug] [MainThread]: On master: COMMIT
[0m04:31:38.105668 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m04:31:38.106927 [debug] [MainThread]: On master: Close
[0m04:31:38.108862 [info ] [MainThread]: 
[0m04:31:38.110014 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.12 seconds (14.12s).
[0m04:31:38.111199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:38.112022 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:31:38.138302 [info ] [MainThread]: 
[0m04:31:38.138864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:38.139430 [info ] [MainThread]: 
[0m04:31:38.140108 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:31:38.140828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c11bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c11b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c10ff40>]}
[0m04:31:38.141453 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:33:17.850299 | 8be5e778-efbd-4119-998d-aeac863f3f2d ==============================
[0m04:33:17.850314 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:33:17.850799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:33:17.851172 [debug] [MainThread]: Tracking: tracking
[0m04:33:17.857949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff650a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff650ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff650af0>]}
[0m04:33:17.989351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:33:17.989858 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:33:18.001520 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:33:18.028155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff5122e0>]}
[0m04:33:18.040321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff532e50>]}
[0m04:33:18.040650 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:33:18.040931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff4da5b0>]}
[0m04:33:18.042623 [info ] [MainThread]: 
[0m04:33:18.043333 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:33:18.044764 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:33:18.055116 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:33:18.055878 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:33:18.056406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:33:18.056787 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:19.297515 [debug] [ThreadPool]: SQL status: SELECT in 1.24 seconds
[0m04:33:19.300961 [debug] [ThreadPool]: On list_dev: Close
[0m04:33:19.304353 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:33:19.313331 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:33:19.314050 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:33:19.314724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:33:19.315339 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:20.690744 [debug] [ThreadPool]: SQL status: BEGIN in 1.38 seconds
[0m04:33:20.692165 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:33:20.693375 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:33:20.819236 [debug] [ThreadPool]: SQL status: SELECT in 0.12 seconds
[0m04:33:20.822617 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:33:20.934993 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:33:20.943668 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:20.944234 [debug] [MainThread]: On master: BEGIN
[0m04:33:20.944774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:33:20.945213 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:22.313198 [debug] [MainThread]: SQL status: BEGIN in 1.37 seconds
[0m04:33:22.314297 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:22.315310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:33:22.469835 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m04:33:22.471187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff512730>]}
[0m04:33:22.471824 [debug] [MainThread]: On master: ROLLBACK
[0m04:33:22.587158 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:22.588479 [debug] [MainThread]: On master: BEGIN
[0m04:33:22.819063 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m04:33:22.819806 [debug] [MainThread]: On master: COMMIT
[0m04:33:22.820387 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:22.820853 [debug] [MainThread]: On master: COMMIT
[0m04:33:22.936785 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:33:22.937798 [debug] [MainThread]: On master: Close
[0m04:33:22.939776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:33:22.940936 [info ] [MainThread]: 
[0m04:33:22.948461 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:33:22.949103 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:33:22.950081 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:22.950502 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:33:22.950900 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:33:22.954800 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:33:22.964647 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:22.965324 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:33:23.002886 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:33:23.008719 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:23.008911 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:33:23.009108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:23.009290 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:24.443506 [debug] [Thread-1  ]: SQL status: BEGIN in 1.43 seconds
[0m04:33:24.444588 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.445370 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:33:24.636691 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m04:33:24.647085 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.648089 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:33:24.773990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:33:24.779537 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.780191 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:33:24.906236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:33:24.931870 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:24.932548 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.933312 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:25.138161 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:33:25.139491 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.140279 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:33:25.266645 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:33:25.275520 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.276386 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:33:25.406477 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m04:33:25.409097 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:25.410161 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.411066 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:25.569670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:33:25.570824 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.571754 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:33:25.698355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:33:25.700407 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:25.701781 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:33:25.858664 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:33:25.861022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efc4108e0>]}
[0m04:33:25.862356 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.91s]
[0m04:33:25.863647 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:33:25.864429 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:33:25.865505 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:33:25.866819 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:25.867510 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:33:25.868095 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:33:25.870415 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:33:25.882185 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:25.882680 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:33:25.903573 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:33:25.916606 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:25.916976 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:33:25.917378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:25.917658 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:27.129507 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
[0m04:33:27.130591 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.131677 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA,
        cast(saletime as date) as DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') as HORA_VENDA
    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:33:27.250971 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:33:27.257204 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.258090 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:33:27.371602 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:33:27.374456 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.374794 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:33:27.487344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:33:27.488993 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:27.489616 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.490100 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:27.631821 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:33:27.633462 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.634312 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:33:27.749892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:33:27.754560 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.755346 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:33:27.871837 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m04:33:27.873311 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:27.873977 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.874599 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:28.012433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:33:28.013805 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:28.014766 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:33:28.128928 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:33:28.130864 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:28.131918 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:33:28.311820 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:33:28.314405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efc379af0>]}
[0m04:33:28.315955 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.45s]
[0m04:33:28.317392 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:33:28.318585 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:33:28.320093 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:33:28.322020 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.322834 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:33:28.323524 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:33:28.327470 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.336881 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:28.337339 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:33:28.341847 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.352646 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.353077 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:33:28.353396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:28.353649 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:29.744608 [debug] [Thread-1  ]: SQL status: BEGIN in 1.39 seconds
[0m04:33:29.745908 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:29.746855 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:33:29.949329 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m04:33:29.954825 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:29.955416 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:33:30.076490 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:33:30.079391 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.080006 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.080617 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.237673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:33:30.238654 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.239239 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:33:30.360384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:33:30.364649 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.365466 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:33:30.563773 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:33:30.565487 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.566180 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.566740 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.714605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:33:30.715683 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.716548 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:33:30.838889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:33:30.840693 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:30.841711 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:33:30.975438 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:33:30.976685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc769d0>]}
[0m04:33:30.977457 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.66s]
[0m04:33:30.978099 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:33:30.980169 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:33:30.980645 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:30.981064 [debug] [MainThread]: On master: BEGIN
[0m04:33:30.981475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:33:30.982022 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:32.052168 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m04:33:32.053323 [debug] [MainThread]: On master: COMMIT
[0m04:33:32.054070 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:32.054684 [debug] [MainThread]: On master: COMMIT
[0m04:33:32.166128 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m04:33:32.167442 [debug] [MainThread]: On master: Close
[0m04:33:32.169823 [info ] [MainThread]: 
[0m04:33:32.170960 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.13 seconds (14.13s).
[0m04:33:32.172182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:33:32.172973 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:33:32.199550 [info ] [MainThread]: 
[0m04:33:32.200494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:33:32.201001 [info ] [MainThread]: 
[0m04:33:32.201423 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:33:32.201935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc88d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc88100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc81f40>]}
[0m04:33:32.202429 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:54:27.360212 | 6e417784-5283-41a1-9bc3-d628f6a94f18 ==============================
[0m04:54:27.360232 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:54:27.361126 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:54:27.361784 [debug] [MainThread]: Tracking: tracking
[0m04:54:27.370474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d80caa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d80caaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d80cab20>]}
[0m04:54:27.514641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:54:27.515147 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/views/tb_10_compradores.sql
[0m04:54:27.527348 [debug] [MainThread]: 1699: static parser successfully parsed views/tb_10_compradores.sql
[0m04:54:27.554269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d7f0f340>]}
[0m04:54:27.566184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d7f28fd0>]}
[0m04:54:27.566523 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:54:27.566839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d7f28f70>]}
[0m04:54:27.568144 [info ] [MainThread]: 
[0m04:54:27.568820 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:54:27.569937 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:54:27.580572 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:54:27.581029 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:54:27.581286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:54:27.581707 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:28.776686 [debug] [ThreadPool]: SQL status: SELECT in 1.2 seconds
[0m04:54:28.778786 [debug] [ThreadPool]: On list_dev: Close
[0m04:54:28.781008 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:54:28.787941 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:54:28.788232 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:54:28.788478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:54:28.788726 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:29.939937 [debug] [ThreadPool]: SQL status: BEGIN in 1.15 seconds
[0m04:54:29.941065 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:54:29.941908 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:54:30.105877 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
[0m04:54:30.108394 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:54:30.218926 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:54:30.229093 [debug] [MainThread]: Using redshift connection "master"
[0m04:54:30.229712 [debug] [MainThread]: On master: BEGIN
[0m04:54:30.230280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:54:30.230855 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:31.335768 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m04:54:31.336260 [debug] [MainThread]: Using redshift connection "master"
[0m04:54:31.336679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:54:31.553353 [debug] [MainThread]: SQL status: SELECT in 0.22 seconds
[0m04:54:31.555647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d803b8e0>]}
[0m04:54:31.556930 [debug] [MainThread]: On master: ROLLBACK
[0m04:54:31.728700 [debug] [MainThread]: Using redshift connection "master"
[0m04:54:31.729963 [debug] [MainThread]: On master: BEGIN
[0m04:54:32.013313 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
[0m04:54:32.014387 [debug] [MainThread]: On master: COMMIT
[0m04:54:32.015292 [debug] [MainThread]: Using redshift connection "master"
[0m04:54:32.016058 [debug] [MainThread]: On master: COMMIT
[0m04:54:32.137924 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:54:32.139048 [debug] [MainThread]: On master: Close
[0m04:54:32.141189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:54:32.142581 [info ] [MainThread]: 
[0m04:54:32.149533 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:54:32.150283 [info ] [Thread-1  ]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:54:32.151342 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:32.151921 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:54:32.152788 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:54:32.156762 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:54:32.168457 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:32.168882 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:54:32.208309 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:54:32.219922 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:32.220215 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:54:32.220440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:54:32.220640 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:33.541817 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
[0m04:54:33.542942 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:33.543810 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:54:33.773492 [debug] [Thread-1  ]: SQL status: SELECT in 0.23 seconds
[0m04:54:33.783522 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:33.784242 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:54:33.908181 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:54:33.911390 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:33.911829 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:54:34.033953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:54:34.051328 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:54:34.052045 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:34.052702 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:54:34.222366 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m04:54:34.223783 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:34.224619 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:54:34.382776 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m04:54:34.387796 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:34.388408 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:54:34.543185 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.15 seconds
[0m04:54:34.545579 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:54:34.546660 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:34.547540 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:54:34.697994 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:54:34.699083 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:54:34.699872 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:54:34.853622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:54:34.855776 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:34.856763 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:54:34.977474 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:54:34.980201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d5049af0>]}
[0m04:54:34.981776 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.83s]
[0m04:54:34.983602 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:54:34.984779 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:54:34.985952 [info ] [Thread-1  ]: 2 of 4 START sql view model public.vw_sales .................................... [RUN]
[0m04:54:34.987907 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:34.988639 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:54:34.989548 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:54:34.992598 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:54:35.003228 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:35.003586 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:54:35.020773 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:54:35.030102 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:35.030452 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:54:35.030695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:54:35.030902 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:36.476437 [debug] [Thread-1  ]: SQL status: BEGIN in 1.45 seconds
[0m04:54:36.477669 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:36.478730 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA,
        cast(saletime as date) as DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') as HORA_VENDA
    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:54:36.662826 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.18 seconds
[0m04:54:36.669014 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:36.669886 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:54:36.816890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
[0m04:54:36.822788 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:36.823777 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:54:36.990866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.17 seconds
[0m04:54:36.995201 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:54:36.996082 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:36.996932 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:54:37.174361 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
[0m04:54:37.175752 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:37.176707 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:54:37.321358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m04:54:37.326545 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:37.327433 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:54:37.472531 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.14 seconds
[0m04:54:37.473593 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:54:37.474230 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:37.474818 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:54:37.648648 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m04:54:37.649888 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:54:37.650727 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:54:37.795383 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m04:54:37.797203 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:37.798168 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:54:37.946096 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:54:37.948337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cf5c49a0>]}
[0m04:54:37.949764 [info ] [Thread-1  ]: 2 of 4 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.96s]
[0m04:54:37.951258 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:54:37.952346 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:54:37.953444 [info ] [Thread-1  ]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:54:37.955419 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:37.956304 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:54:37.957074 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:54:37.961710 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:54:37.971474 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:37.971860 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:54:37.976713 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:54:37.986640 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:37.986952 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:54:37.987199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:54:37.987680 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:39.072195 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m04:54:39.072596 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.072936 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:54:39.191460 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:54:39.195584 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.196168 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:54:39.379294 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.18 seconds
[0m04:54:39.382525 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:54:39.383280 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.383847 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:54:39.527051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:54:39.528759 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.529678 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:54:39.647879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:54:39.650398 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.650916 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:54:39.835581 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:54:39.838180 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:54:39.839146 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.840079 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:54:39.982231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:54:39.983324 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:54:39.984226 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:54:40.101494 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:54:40.103212 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:40.104141 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:54:40.220057 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:54:40.221993 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cf5e3040>]}
[0m04:54:40.223056 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.27s]
[0m04:54:40.224173 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:54:40.225034 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m04:54:40.225964 [info ] [Thread-1  ]: 4 of 4 START sql view model public.tb_10_compradores ........................... [RUN]
[0m04:54:40.227342 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:40.227835 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m04:54:40.228336 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m04:54:40.233534 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m04:54:40.243904 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:40.244436 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m04:54:40.249284 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.tb_10_compradores"
[0m04:54:40.257540 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:40.258005 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m04:54:40.258378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:54:40.258819 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:41.378502 [debug] [Thread-1  ]: SQL status: BEGIN in 1.12 seconds
[0m04:54:41.379677 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:41.380493 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */


  create view "dev"."public"."tb_10_compradores__dbt_tmp" as (
    with sales as (
    select
        *
    from "dev"."public"."vw_sales"
),

compradores as(
    SELECT
        (firstname ||' '|| lastname) as nome_completo,
        userid
    from users
),

top_10_compradores as (
    SELECT
        compradores.nome_completo as nome_completo,
        sum(sales.QUANTIDADE_VENDIDA) as vendas_totais,
        sales.COMISSAO as comissao
    from sales inner join compradores
    on sales.ID_COMPRADOR = compradores.userid
    group by compradores.userid, compradores.nome_completo, sales.comissao
    order by vendas_totais DESC
    limit 10
)

SELECT
    *
from top_10_compradores
  ) ;

[0m04:54:41.498713 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:54:41.503020 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:41.503879 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m04:54:41.617427 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:54:41.620253 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:54:41.621104 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:41.621991 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:54:41.846188 [debug] [Thread-1  ]: SQL status: COMMIT in 0.22 seconds
[0m04:54:41.847748 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:41.848708 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m04:54:41.960479 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:54:41.963212 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:41.963838 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop view if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m04:54:42.074930 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.11 seconds
[0m04:54:42.076217 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:54:42.076726 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:42.077125 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:54:42.213041 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:54:42.214157 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:54:42.214981 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m04:54:42.326126 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:54:42.327490 [debug] [Thread-1  ]: finished collecting timing info
[0m04:54:42.328091 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m04:54:42.439332 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m04:54:42.440775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e417784-5283-41a1-9bc3-d628f6a94f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9cf5c49a0>]}
[0m04:54:42.441715 [info ] [Thread-1  ]: 4 of 4 OK created sql view model public.tb_10_compradores ...................... [[32mCREATE VIEW[0m in 2.21s]
[0m04:54:42.442570 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m04:54:42.444791 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:54:42.445246 [debug] [MainThread]: Using redshift connection "master"
[0m04:54:42.445701 [debug] [MainThread]: On master: BEGIN
[0m04:54:42.446036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:54:42.446391 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:54:43.635514 [debug] [MainThread]: SQL status: BEGIN in 1.19 seconds
[0m04:54:43.636894 [debug] [MainThread]: On master: COMMIT
[0m04:54:43.637963 [debug] [MainThread]: Using redshift connection "master"
[0m04:54:43.638767 [debug] [MainThread]: On master: COMMIT
[0m04:54:43.756117 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:54:43.757285 [debug] [MainThread]: On master: Close
[0m04:54:43.758876 [info ] [MainThread]: 
[0m04:54:43.759755 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 16.19 seconds (16.19s).
[0m04:54:43.760444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:54:43.760919 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m04:54:43.780289 [info ] [MainThread]: 
[0m04:54:43.781010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:54:43.781542 [info ] [MainThread]: 
[0m04:54:43.782044 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:54:43.782697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d7f28eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d58c7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d58c7fd0>]}
[0m04:54:43.783300 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:57:43.038866 | 243b3d94-49be-4891-b5ff-03307f871bf9 ==============================
[0m04:57:43.038880 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:57:43.039391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:57:43.039616 [debug] [MainThread]: Tracking: tracking
[0m04:57:43.046776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da46088b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da4608970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da46089a0>]}
[0m04:57:43.082208 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:57:43.082725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da45e0730>]}
[0m04:57:43.229695 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:57:43.231750 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:57:43.249813 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:57:43.258416 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:57:43.259484 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:57:43.260328 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:57:43.261282 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:57:43.263711 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:57:43.264324 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:57:43.265191 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:57:43.265778 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:57:43.266322 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:57:43.266811 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:57:43.267469 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:57:43.267893 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:57:43.268359 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:57:43.269075 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:57:43.271262 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:57:43.287348 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:57:43.289081 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:57:43.290211 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:57:43.291600 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:57:43.292639 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:57:43.293836 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:57:43.294746 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:57:43.299270 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:57:43.299823 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:57:43.300397 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:57:43.301660 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:57:43.305744 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:57:43.312307 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:57:43.321505 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:57:43.324598 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:57:43.326135 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:57:43.335355 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:57:43.337885 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:57:43.339928 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:57:43.341942 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:57:43.347506 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:57:43.349477 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:57:43.350877 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:57:43.352107 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:57:43.357685 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:57:43.361503 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:57:43.362359 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:57:43.363172 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:57:43.363907 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:57:43.365010 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:57:43.366699 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:57:43.369284 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:57:43.370625 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:57:43.371979 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:57:43.375204 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:57:43.386826 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:57:43.391473 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:57:43.393000 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:57:43.400819 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:57:43.411634 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:57:43.419690 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:57:43.430343 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:57:43.439622 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:57:43.446498 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:57:43.450997 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:57:43.452247 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:57:43.457514 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:57:43.459869 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:57:43.461443 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:57:43.465215 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:57:43.466997 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:57:43.469429 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:57:43.473130 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:57:43.475063 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:57:43.476272 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:57:43.478234 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:57:43.479134 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:57:43.480179 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:57:43.481223 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:57:43.482120 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:57:43.482980 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:57:43.483983 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:57:43.484895 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:57:43.485878 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:57:43.487227 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:57:43.488046 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:57:43.488962 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:57:43.489820 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:57:43.490731 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:57:43.491612 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:57:43.492567 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:57:43.493591 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:57:43.498086 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:57:43.498879 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:57:43.500060 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:57:43.501087 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:57:43.502053 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:57:43.683558 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:57:43.692252 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:57:43.694840 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m04:57:43.697106 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:57:43.788923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da44629d0>]}
[0m04:57:43.802198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da448e4c0>]}
[0m04:57:43.802640 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:57:43.802977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da45e0490>]}
[0m04:57:43.804071 [info ] [MainThread]: 
[0m04:57:43.805152 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:57:43.806451 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:57:43.817587 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:57:43.818136 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:57:43.818445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:43.818637 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:57:45.550577 [debug] [ThreadPool]: SQL status: SELECT in 1.73 seconds
[0m04:57:45.554106 [debug] [ThreadPool]: On list_dev: Close
[0m04:57:45.558303 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:57:45.568831 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:57:45.569536 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:57:45.570152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:57:45.570884 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:57:46.929607 [debug] [ThreadPool]: SQL status: BEGIN in 1.36 seconds
[0m04:57:46.930771 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:57:46.931551 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:57:47.063306 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m04:57:47.065056 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:57:47.198666 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:57:47.203775 [debug] [MainThread]: Using redshift connection "master"
[0m04:57:47.204297 [debug] [MainThread]: On master: BEGIN
[0m04:57:47.204789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:57:47.205258 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:57:48.341324 [debug] [MainThread]: SQL status: BEGIN in 1.14 seconds
[0m04:57:48.342632 [debug] [MainThread]: Using redshift connection "master"
[0m04:57:48.343776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:57:48.510045 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
[0m04:57:48.513228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da4462700>]}
[0m04:57:48.514555 [debug] [MainThread]: On master: ROLLBACK
[0m04:57:48.640694 [debug] [MainThread]: Using redshift connection "master"
[0m04:57:48.641835 [debug] [MainThread]: On master: BEGIN
[0m04:57:48.893709 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
[0m04:57:48.894843 [debug] [MainThread]: On master: COMMIT
[0m04:57:48.895825 [debug] [MainThread]: Using redshift connection "master"
[0m04:57:48.896804 [debug] [MainThread]: On master: COMMIT
[0m04:57:49.022666 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:57:49.023671 [debug] [MainThread]: On master: Close
[0m04:57:49.025483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:57:49.026548 [info ] [MainThread]: 
[0m04:57:49.033293 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:57:49.034130 [info ] [Thread-1  ]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:57:49.035206 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:49.035650 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:57:49.036335 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:57:49.040541 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:57:49.051114 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:49.051570 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:57:49.088780 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:57:49.099986 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:49.100464 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:57:49.100909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:57:49.101136 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:57:50.610802 [debug] [Thread-1  ]: SQL status: BEGIN in 1.51 seconds
[0m04:57:50.611858 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:50.612760 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:57:50.814270 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m04:57:50.824013 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:50.824617 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:57:51.380705 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.56 seconds
[0m04:57:51.383983 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:51.384548 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:57:51.545171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m04:57:51.565192 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:57:51.565915 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:51.566672 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:57:51.734047 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m04:57:51.735465 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:51.736246 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:57:51.862398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:57:51.870680 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:51.871259 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:57:51.997050 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m04:57:51.999422 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:57:52.000387 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:52.001148 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:57:52.158489 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:57:52.159633 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:57:52.160464 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:57:52.349223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m04:57:52.350185 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:52.350570 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:57:52.614282 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:57:52.616660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da44b7f10>]}
[0m04:57:52.618033 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 3.58s]
[0m04:57:52.619376 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:57:52.620331 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:57:52.621727 [info ] [Thread-1  ]: 2 of 4 START sql view model public.vw_sales .................................... [RUN]
[0m04:57:52.623202 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:52.623753 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:57:52.624362 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:57:52.627372 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:57:52.636575 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:52.636961 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:57:52.652136 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:57:52.668280 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:52.668823 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:57:52.669283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:57:52.669690 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:57:53.997620 [debug] [Thread-1  ]: SQL status: BEGIN in 1.33 seconds
[0m04:57:53.998672 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:53.999718 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA,
        cast(saletime as date) as DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') as HORA_VENDA
    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:57:54.114000 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.11 seconds
[0m04:57:54.118454 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:54.119055 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:57:54.230581 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:57:54.236146 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:54.236968 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:57:54.424877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.19 seconds
[0m04:57:54.429198 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:57:54.430165 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:54.431055 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:57:54.569096 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:57:54.570485 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:54.571427 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:57:54.753730 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m04:57:54.755751 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:54.756112 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:57:54.867011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.11 seconds
[0m04:57:54.869105 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:57:54.869887 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:54.870702 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:57:55.014430 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:57:55.015482 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:57:55.016357 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:57:55.125581 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:57:55.127269 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:55.128235 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:57:55.328301 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:57:55.330512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9dbd7730>]}
[0m04:57:55.331934 [info ] [Thread-1  ]: 2 of 4 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.71s]
[0m04:57:55.333278 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:57:55.334218 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:57:55.335373 [info ] [Thread-1  ]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:57:55.337048 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:55.337744 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:57:55.338532 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:57:55.343106 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:57:55.352371 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:55.352825 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:57:55.358441 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:57:55.368377 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:55.368795 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:57:55.369050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:57:55.369330 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:57:56.871787 [debug] [Thread-1  ]: SQL status: BEGIN in 1.5 seconds
[0m04:57:56.872958 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:56.873848 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:57:56.998610 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:57:57.003883 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:57.004543 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:57:57.162414 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m04:57:57.164300 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:57:57.164975 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:57.165426 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:57:57.368595 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:57:57.369467 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:57.370141 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:57:57.572522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
[0m04:57:57.577629 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:57.578553 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:57:57.700378 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m04:57:57.701861 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:57:57.702514 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:57.703035 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:57:57.887672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.18 seconds
[0m04:57:57.888602 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:57:57.889230 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:57:58.032770 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m04:57:58.033916 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:58.034531 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:57:58.157092 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:57:58.158365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9c359fd0>]}
[0m04:57:58.159145 [info ] [Thread-1  ]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.82s]
[0m04:57:58.160137 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:57:58.161147 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_10_compradores
[0m04:57:58.162233 [info ] [Thread-1  ]: 4 of 4 START sql table model public.tb_10_compradores .......................... [RUN]
[0m04:57:58.163348 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:57:58.163859 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_10_compradores
[0m04:57:58.164429 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_10_compradores
[0m04:57:58.167490 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_10_compradores"
[0m04:57:58.182941 [debug] [Thread-1  ]: finished collecting timing info
[0m04:57:58.183254 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_10_compradores
[0m04:57:58.186830 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.tb_10_compradores"
[0m04:57:58.195940 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:57:58.196502 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m04:57:58.196893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:57:58.197503 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:58:01.212235 [debug] [Thread-1  ]: SQL status: BEGIN in 3.02 seconds
[0m04:58:01.212806 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:01.213230 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as (
    select
        *
    from "dev"."public"."vw_sales"
),

compradores as(
    SELECT
        (firstname ||' '|| lastname) as nome_completo,
        userid
    from users
),

top_10_compradores as (
    SELECT
        compradores.nome_completo as nome_completo,
        sum(sales.QUANTIDADE_VENDIDA) as vendas_totais,
        sales.COMISSAO as comissao
    from sales inner join compradores
    on sales.ID_COMPRADOR = compradores.userid
    group by compradores.userid, compradores.nome_completo, sales.comissao
    order by vendas_totais DESC
    limit 10
)

SELECT
    *
from top_10_compradores
  );
  
[0m04:58:07.819282 [debug] [Thread-1  ]: SQL status: SELECT in 6.61 seconds
[0m04:58:07.825441 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:07.826297 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
alter table "dev"."public"."tb_10_compradores__dbt_tmp" rename to "tb_10_compradores"
[0m04:58:07.993807 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.17 seconds
[0m04:58:07.998400 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:58:07.999312 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:08.000251 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:58:08.203005 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:58:08.203828 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:08.204260 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m04:58:08.368659 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m04:58:08.374015 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:08.375040 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_10_compradores"} */
drop table if exists "dev"."public"."tb_10_compradores__dbt_backup" cascade
[0m04:58:08.542303 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.17 seconds
[0m04:58:08.544389 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:58:08.545029 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:08.545527 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: COMMIT
[0m04:58:08.761710 [debug] [Thread-1  ]: SQL status: COMMIT in 0.22 seconds
[0m04:58:08.762540 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_10_compradores"
[0m04:58:08.763144 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: BEGIN
[0m04:58:08.948503 [debug] [Thread-1  ]: SQL status: BEGIN in 0.18 seconds
[0m04:58:08.949791 [debug] [Thread-1  ]: finished collecting timing info
[0m04:58:08.950609 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: ROLLBACK
[0m04:58:09.078895 [debug] [Thread-1  ]: On model.analytics_dbt.tb_10_compradores: Close
[0m04:58:09.080704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '243b3d94-49be-4891-b5ff-03307f871bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9c360e20>]}
[0m04:58:09.081750 [info ] [Thread-1  ]: 4 of 4 OK created sql table model public.tb_10_compradores ..................... [[32mSELECT[0m in 10.92s]
[0m04:58:09.082572 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_10_compradores
[0m04:58:09.084700 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:58:09.085204 [debug] [MainThread]: Using redshift connection "master"
[0m04:58:09.085694 [debug] [MainThread]: On master: BEGIN
[0m04:58:09.086108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:09.086465 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:58:10.577685 [debug] [MainThread]: SQL status: BEGIN in 1.49 seconds
[0m04:58:10.579012 [debug] [MainThread]: On master: COMMIT
[0m04:58:10.580010 [debug] [MainThread]: Using redshift connection "master"
[0m04:58:10.580815 [debug] [MainThread]: On master: COMMIT
[0m04:58:10.703280 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:58:10.704038 [debug] [MainThread]: On master: Close
[0m04:58:10.705140 [info ] [MainThread]: 
[0m04:58:10.705730 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 26.90 seconds (26.90s).
[0m04:58:10.706568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:10.707373 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_10_compradores' was properly closed.
[0m04:58:10.729584 [info ] [MainThread]: 
[0m04:58:10.730410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:58:10.731029 [info ] [MainThread]: 
[0m04:58:10.731458 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m04:58:10.732060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da46089a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9c33bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9c33b820>]}
[0m04:58:10.732588 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 05:14:51.276642 | 3bc432aa-5c24-4f72-b2ee-ae0ff0e870e0 ==============================
[0m05:14:51.276656 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:14:51.277187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/table/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:14:51.277562 [debug] [MainThread]: Tracking: tracking
[0m05:14:51.285481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73732938b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373293970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73732939a0>]}
[0m05:14:51.414365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:14:51.414833 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/tables/tb_vendas_primeiro_trimestre.sql
[0m05:14:51.425177 [debug] [MainThread]: 1603: static parser failed on tables/tb_vendas_primeiro_trimestre.sql
[0m05:14:51.435022 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tables/tb_vendas_primeiro_trimestre.sql
[0m05:14:51.450955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc432aa-5c24-4f72-b2ee-ae0ff0e870e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73730ec640>]}
[0m05:14:51.462436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc432aa-5c24-4f72-b2ee-ae0ff0e870e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373132e20>]}
[0m05:14:51.462761 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:14:51.463033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc432aa-5c24-4f72-b2ee-ae0ff0e870e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373132f70>]}
[0m05:14:51.464928 [warn ] [MainThread]: The selection criterion 'models/table/tb_vendas_primeiro_trimestre.sql' does not match any nodes
[0m05:14:51.465693 [info ] [MainThread]: 
[0m05:14:51.465976 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m05:14:51.478897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373293b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73732938b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7373293ac0>]}
[0m05:14:51.479298 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 05:15:18.402955 | 0db2eab1-b6f2-4329-8562-6b759e63159f ==============================
[0m05:15:18.402968 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:15:18.403524 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/tables/tb_vendas_primeiro_trimestre.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:15:18.403841 [debug] [MainThread]: Tracking: tracking
[0m05:15:18.410629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a571d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a571da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a571da30>]}
[0m05:15:18.543937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:15:18.544279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:15:18.548839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0db2eab1-b6f2-4329-8562-6b759e63159f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a561c2e0>]}
[0m05:15:18.559780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0db2eab1-b6f2-4329-8562-6b759e63159f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a56abd90>]}
[0m05:15:18.560054 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:15:18.560320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0db2eab1-b6f2-4329-8562-6b759e63159f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a56abb80>]}
[0m05:15:18.565649 [info ] [MainThread]: 
[0m05:15:18.566464 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m05:15:18.567675 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m05:15:18.577928 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m05:15:18.578493 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m05:15:18.578929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:15:18.579123 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:15:20.044999 [debug] [ThreadPool]: SQL status: SELECT in 1.47 seconds
[0m05:15:20.049011 [debug] [ThreadPool]: On list_dev: Close
[0m05:15:20.053376 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m05:15:20.063663 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m05:15:20.064319 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m05:15:20.064954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:15:20.065540 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:15:21.502908 [debug] [ThreadPool]: SQL status: BEGIN in 1.44 seconds
[0m05:15:21.504291 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m05:15:21.505250 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:15:21.656765 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
[0m05:15:21.660764 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m05:15:21.791837 [debug] [ThreadPool]: On list_dev_public: Close
[0m05:15:21.799350 [debug] [MainThread]: Using redshift connection "master"
[0m05:15:21.800120 [debug] [MainThread]: On master: BEGIN
[0m05:15:21.800719 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:15:21.801204 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:15:22.891125 [debug] [MainThread]: SQL status: BEGIN in 1.09 seconds
[0m05:15:22.892499 [debug] [MainThread]: Using redshift connection "master"
[0m05:15:22.893730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:15:23.097649 [debug] [MainThread]: SQL status: SELECT in 0.2 seconds
[0m05:15:23.101015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0db2eab1-b6f2-4329-8562-6b759e63159f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a561c5b0>]}
[0m05:15:23.102455 [debug] [MainThread]: On master: ROLLBACK
[0m05:15:23.216971 [debug] [MainThread]: Using redshift connection "master"
[0m05:15:23.218586 [debug] [MainThread]: On master: BEGIN
[0m05:15:23.607285 [debug] [MainThread]: SQL status: BEGIN in 0.39 seconds
[0m05:15:23.608873 [debug] [MainThread]: On master: COMMIT
[0m05:15:23.610081 [debug] [MainThread]: Using redshift connection "master"
[0m05:15:23.611230 [debug] [MainThread]: On master: COMMIT
[0m05:15:23.811614 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m05:15:23.812492 [debug] [MainThread]: On master: Close
[0m05:15:23.813456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:15:23.814163 [info ] [MainThread]: 
[0m05:15:23.818180 [debug] [Thread-1  ]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m05:15:23.818802 [info ] [Thread-1  ]: 1 of 1 START sql table model public.tb_vendas_primeiro_trimestre ............... [RUN]
[0m05:15:23.819805 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:23.820237 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m05:15:23.820770 [debug] [Thread-1  ]: Compiling model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m05:15:23.824742 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:23.833708 [debug] [Thread-1  ]: finished collecting timing info
[0m05:15:23.833980 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m05:15:23.866934 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:23.872636 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:23.872825 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m05:15:23.873021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:23.873205 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:15:25.282305 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m05:15:25.283702 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:25.284791 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */

  
    

  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    


with source_data as(
    select
        dateid as id_date,
        month as mes,
        year as ano
    from date
),

sales_date as(
    select
        source_data.mes,
        sum(QUANTIDADE_VENDIDA)
    from "dev"."public"."vw_sales" as sales
    inner join source_data
    on sales.id_date = source_data.id_date
    where source_data.mes in ('JAN', 'FEB', 'MAR')
    and source_data.ano = '2008'
    group by source_data.mes
)

select * from sales_date
  );
  
[0m05:15:37.644195 [debug] [Thread-1  ]: SQL status: SELECT in 12.36 seconds
[0m05:15:37.654715 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:37.655473 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
[0m05:15:37.795941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m05:15:37.817423 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m05:15:37.818014 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:37.818744 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m05:15:38.363929 [debug] [Thread-1  ]: SQL status: COMMIT in 0.54 seconds
[0m05:15:38.365550 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:38.366537 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m05:15:38.504088 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m05:15:38.508811 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:38.509440 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
[0m05:15:39.140430 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.63 seconds
[0m05:15:39.143189 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m05:15:39.144443 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:39.145603 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m05:15:39.287087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m05:15:39.288239 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m05:15:39.289242 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m05:15:39.482392 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m05:15:39.484646 [debug] [Thread-1  ]: finished collecting timing info
[0m05:15:39.486038 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
[0m05:15:39.710301 [debug] [Thread-1  ]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
[0m05:15:39.713015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0db2eab1-b6f2-4329-8562-6b759e63159f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a44c5220>]}
[0m05:15:39.714756 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.tb_vendas_primeiro_trimestre .......... [[32mSELECT[0m in 15.89s]
[0m05:15:39.716503 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m05:15:39.720818 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m05:15:39.721727 [debug] [MainThread]: Using redshift connection "master"
[0m05:15:39.722497 [debug] [MainThread]: On master: BEGIN
[0m05:15:39.723238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:15:39.724057 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:15:41.220066 [debug] [MainThread]: SQL status: BEGIN in 1.5 seconds
[0m05:15:41.220847 [debug] [MainThread]: On master: COMMIT
[0m05:15:41.221368 [debug] [MainThread]: Using redshift connection "master"
[0m05:15:41.221815 [debug] [MainThread]: On master: COMMIT
[0m05:15:41.426872 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m05:15:41.427914 [debug] [MainThread]: On master: Close
[0m05:15:41.429074 [info ] [MainThread]: 
[0m05:15:41.429756 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.86 seconds (22.86s).
[0m05:15:41.430454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:15:41.430964 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_vendas_primeiro_trimestre' was properly closed.
[0m05:15:41.449277 [info ] [MainThread]: 
[0m05:15:41.449816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:15:41.450264 [info ] [MainThread]: 
[0m05:15:41.450677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:15:41.451180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a56abe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a56abdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19a4d26e50>]}
[0m05:15:41.451628 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 05:35:46.241966 | 25332b4f-0e76-455f-87c5-5969fab4770b ==============================
[0m05:35:46.241983 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:35:46.242831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m05:35:46.243410 [debug] [MainThread]: Tracking: tracking
[0m05:35:46.251822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d87f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d87f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d87f970>]}
[0m05:35:46.400690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m05:35:46.401142 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests/test_singular_nao_negativo.sql
[0m05:35:46.436325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25332b4f-0e76-455f-87c5-5969fab4770b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d721670>]}
[0m05:35:46.449777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25332b4f-0e76-455f-87c5-5969fab4770b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d807f70>]}
[0m05:35:46.450137 [info ] [MainThread]: Found 5 models, 5 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:35:46.450753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25332b4f-0e76-455f-87c5-5969fab4770b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d807fd0>]}
[0m05:35:46.452339 [info ] [MainThread]: 
[0m05:35:46.453254 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m05:35:46.454759 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m05:35:46.465453 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m05:35:46.466025 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m05:35:46.466703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:35:46.467070 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:47.938452 [debug] [ThreadPool]: SQL status: BEGIN in 1.47 seconds
[0m05:35:47.939576 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m05:35:47.940494 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:35:48.070496 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m05:35:48.072299 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m05:35:48.232152 [debug] [ThreadPool]: On list_dev_public: Close
[0m05:35:48.236742 [debug] [MainThread]: Using redshift connection "master"
[0m05:35:48.237185 [debug] [MainThread]: On master: BEGIN
[0m05:35:48.237432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:35:48.237727 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:49.308281 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m05:35:49.309011 [debug] [MainThread]: Using redshift connection "master"
[0m05:35:49.309616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:35:49.462871 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m05:35:49.465007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25332b4f-0e76-455f-87c5-5969fab4770b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d807a90>]}
[0m05:35:49.465791 [debug] [MainThread]: On master: ROLLBACK
[0m05:35:49.625518 [debug] [MainThread]: Using redshift connection "master"
[0m05:35:49.626750 [debug] [MainThread]: On master: BEGIN
[0m05:35:49.863093 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m05:35:49.864413 [debug] [MainThread]: On master: COMMIT
[0m05:35:49.865434 [debug] [MainThread]: Using redshift connection "master"
[0m05:35:49.866456 [debug] [MainThread]: On master: COMMIT
[0m05:35:49.984194 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m05:35:49.985448 [debug] [MainThread]: On master: Close
[0m05:35:49.987560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:35:49.988816 [info ] [MainThread]: 
[0m05:35:49.996893 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:35:49.997447 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m05:35:49.998598 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:35:49.999339 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:35:50.000158 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:35:50.017524 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:35:50.035421 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:50.035751 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:35:50.047410 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:35:50.062425 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:35:50.062852 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m05:35:50.063151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:35:50.063447 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:51.277431 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
[0m05:35:51.278275 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:35:51.278907 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m05:35:51.611346 [debug] [Thread-1  ]: SQL status: SELECT in 0.33 seconds
[0m05:35:51.616076 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:51.616869 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m05:35:51.816760 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m05:35:51.819141 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.82s]
[0m05:35:51.820848 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:35:51.821941 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:35:51.822938 [info ] [Thread-1  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m05:35:51.825004 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:35:51.825627 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:35:51.826201 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:35:51.832273 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:35:51.844455 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:51.844946 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:35:51.847595 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:35:51.856571 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:35:51.857026 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m05:35:51.857531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:35:51.858114 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:53.245376 [debug] [Thread-1  ]: SQL status: BEGIN in 1.39 seconds
[0m05:35:53.246265 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:35:53.247061 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m05:35:53.377337 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m05:35:53.379197 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:53.379763 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m05:35:53.500457 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m05:35:53.502224 [info ] [Thread-1  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.68s]
[0m05:35:53.503195 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:35:53.503895 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m05:35:53.504516 [info ] [Thread-1  ]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m05:35:53.505591 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m05:35:53.506101 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m05:35:53.506608 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m05:35:53.509179 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m05:35:53.522224 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:53.522628 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m05:35:53.525054 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m05:35:53.535348 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m05:35:53.535680 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m05:35:53.535914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:35:53.536144 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:54.647630 [debug] [Thread-1  ]: SQL status: BEGIN in 1.11 seconds
[0m05:35:54.648623 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m05:35:54.649320 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m05:35:54.859303 [debug] [Thread-1  ]: SQL status: SELECT in 0.21 seconds
[0m05:35:54.862085 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:54.862760 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m05:35:54.975568 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m05:35:54.977414 [info ] [Thread-1  ]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.47s]
[0m05:35:54.978415 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m05:35:54.978944 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:35:54.979514 [info ] [Thread-1  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m05:35:54.980764 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:35:54.981213 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:35:54.981738 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:35:54.991868 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:35:55.004580 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:55.005042 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:35:55.007843 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:35:55.018121 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:35:55.018506 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m05:35:55.018871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:35:55.019158 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:56.210990 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
[0m05:35:56.211767 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:35:56.212362 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:35:56.468514 [debug] [Thread-1  ]: SQL status: SELECT in 0.26 seconds
[0m05:35:56.474080 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:56.474868 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m05:35:56.596221 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m05:35:56.598636 [info ] [Thread-1  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.62s]
[0m05:35:56.600051 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:35:56.601000 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:35:56.601919 [info ] [Thread-1  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m05:35:56.603227 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:35:56.603708 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:35:56.604210 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:35:56.610103 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:35:56.620374 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:56.620782 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:35:56.623310 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:35:56.633257 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:35:56.633622 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m05:35:56.633879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:35:56.634079 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:57.999653 [debug] [Thread-1  ]: SQL status: BEGIN in 1.37 seconds
[0m05:35:58.000101 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:35:58.000345 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:35:58.230074 [debug] [Thread-1  ]: SQL status: SELECT in 0.23 seconds
[0m05:35:58.232046 [debug] [Thread-1  ]: finished collecting timing info
[0m05:35:58.232731 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m05:35:58.427367 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m05:35:58.429737 [info ] [Thread-1  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.83s]
[0m05:35:58.431385 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:35:58.434889 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m05:35:58.435494 [debug] [MainThread]: Using redshift connection "master"
[0m05:35:58.436052 [debug] [MainThread]: On master: BEGIN
[0m05:35:58.436586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:35:58.437129 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:35:59.648675 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
[0m05:35:59.649891 [debug] [MainThread]: On master: COMMIT
[0m05:35:59.650996 [debug] [MainThread]: Using redshift connection "master"
[0m05:35:59.652128 [debug] [MainThread]: On master: COMMIT
[0m05:35:59.774758 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m05:35:59.775836 [debug] [MainThread]: On master: Close
[0m05:35:59.777259 [info ] [MainThread]: 
[0m05:35:59.777920 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 13.32 seconds (13.32s).
[0m05:35:59.778596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:35:59.779038 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m05:35:59.798848 [info ] [MainThread]: 
[0m05:35:59.799385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:35:59.799841 [info ] [MainThread]: 
[0m05:35:59.800418 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m05:35:59.801028 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m05:35:59.801541 [info ] [MainThread]: 
[0m05:35:59.802067 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m05:35:59.802645 [info ] [MainThread]: 
[0m05:35:59.803292 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m05:35:59.803969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d807eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63d807e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd63ce167f0>]}
[0m05:35:59.804428 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 05:55:53.907944 | 47e454ee-0a96-4295-ab65-68d6007f14ee ==============================
[0m05:55:53.907961 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:55:53.908478 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m05:55:53.908853 [debug] [MainThread]: Tracking: tracking
[0m05:55:53.917288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5461484970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5461484a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5461484a60>]}
[0m05:55:54.043580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:55:54.044359 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros/test_nao_negativo.sql
[0m05:55:54.044984 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
[0m05:55:54.045429 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
[0m05:55:54.090508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e454ee-0a96-4295-ab65-68d6007f14ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54612993a0>]}
[0m05:55:54.103485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e454ee-0a96-4295-ab65-68d6007f14ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54612f2b20>]}
[0m05:55:54.103819 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:55:54.104150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e454ee-0a96-4295-ab65-68d6007f14ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54612f2a90>]}
[0m05:55:54.105820 [info ] [MainThread]: 
[0m05:55:54.107363 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m05:55:54.109621 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m05:55:54.120273 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m05:55:54.120764 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m05:55:54.121630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:54.122304 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:55:56.162675 [debug] [ThreadPool]: SQL status: BEGIN in 2.04 seconds
[0m05:55:56.163372 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m05:55:56.164072 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:55:56.319662 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
[0m05:55:56.321219 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m05:55:56.520137 [debug] [ThreadPool]: On list_dev_public: Close
[0m05:55:56.529884 [debug] [MainThread]: Using redshift connection "master"
[0m05:55:56.530543 [debug] [MainThread]: On master: BEGIN
[0m05:55:56.531091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:56.531723 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:55:57.774013 [debug] [MainThread]: SQL status: BEGIN in 1.24 seconds
[0m05:55:57.775235 [debug] [MainThread]: Using redshift connection "master"
[0m05:55:57.776202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:57.937899 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m05:55:57.941212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e454ee-0a96-4295-ab65-68d6007f14ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54612a7370>]}
[0m05:55:57.942356 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:58.072215 [debug] [MainThread]: Using redshift connection "master"
[0m05:55:58.073084 [debug] [MainThread]: On master: BEGIN
[0m05:55:58.310069 [debug] [MainThread]: SQL status: BEGIN in 0.24 seconds
[0m05:55:58.310746 [debug] [MainThread]: On master: COMMIT
[0m05:55:58.311241 [debug] [MainThread]: Using redshift connection "master"
[0m05:55:58.311751 [debug] [MainThread]: On master: COMMIT
[0m05:55:58.518806 [debug] [MainThread]: SQL status: COMMIT in 0.21 seconds
[0m05:55:58.519986 [debug] [MainThread]: On master: Close
[0m05:55:58.522346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:55:58.523580 [info ] [MainThread]: 
[0m05:55:58.530186 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m05:55:58.530911 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m05:55:58.532097 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m05:55:58.532525 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m05:55:58.533162 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m05:55:58.538375 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m05:55:58.550426 [debug] [Thread-1  ]: finished collecting timing info
[0m05:55:58.551273 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m05:55:58.564144 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m05:55:58.570817 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m05:55:58.571203 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m05:55:58.571524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:55:58.571706 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:55:59.979195 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m05:55:59.980491 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m05:55:59.981476 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m05:56:00.100195 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m05:56:00.103602 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:00.104462 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m05:56:00.303070 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m05:56:00.305440 [info ] [Thread-1  ]: 1 of 7 PASS nao_negativo_tb_10_compradores_vendas_totais ....................... [[32mPASS[0m in 1.77s]
[0m05:56:00.307186 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m05:56:00.308429 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:56:00.309790 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m05:56:00.311687 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:56:00.312501 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:56:00.313070 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:56:00.321894 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:56:00.332277 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:00.332695 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:56:00.335197 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:56:00.346756 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:56:00.347225 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m05:56:00.347560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:56:00.347871 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:01.432403 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m05:56:01.433515 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m05:56:01.434433 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m05:56:01.559147 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m05:56:01.562422 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:01.563472 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m05:56:01.676475 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m05:56:01.677739 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.37s]
[0m05:56:01.678724 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m05:56:01.679551 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:56:01.680133 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m05:56:01.681159 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:56:01.681633 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:56:01.682153 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:56:01.686746 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:56:01.697861 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:01.698277 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:56:01.700152 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:56:01.708341 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:56:01.708895 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m05:56:01.709372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:56:01.710014 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:03.032262 [debug] [Thread-1  ]: SQL status: BEGIN in 1.32 seconds
[0m05:56:03.033140 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m05:56:03.033832 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m05:56:03.167302 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m05:56:03.169653 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:03.170362 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m05:56:03.294539 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m05:56:03.296878 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.62s]
[0m05:56:03.298559 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m05:56:03.299654 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m05:56:03.300754 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m05:56:03.302630 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m05:56:03.303391 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m05:56:03.304046 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m05:56:03.310571 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m05:56:03.321230 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:03.321707 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m05:56:03.325009 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m05:56:03.332603 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m05:56:03.332934 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m05:56:03.333172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:56:03.333391 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:04.662489 [debug] [Thread-1  ]: SQL status: BEGIN in 1.33 seconds
[0m05:56:04.663664 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m05:56:04.664682 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m05:56:04.917342 [debug] [Thread-1  ]: SQL status: SELECT in 0.25 seconds
[0m05:56:04.920595 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:04.921707 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m05:56:05.074139 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m05:56:05.075612 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.77s]
[0m05:56:05.076653 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m05:56:05.077462 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m05:56:05.078090 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m05:56:05.079504 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m05:56:05.080081 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m05:56:05.080743 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m05:56:05.083359 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m05:56:05.095524 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:05.096150 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m05:56:05.098195 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m05:56:05.106810 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m05:56:05.107468 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m05:56:05.108046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:56:05.108769 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:06.638093 [debug] [Thread-1  ]: SQL status: BEGIN in 1.53 seconds
[0m05:56:06.638810 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m05:56:06.639438 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m05:56:06.817515 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m05:56:06.819592 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:06.820241 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m05:56:06.940300 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m05:56:06.942798 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.86s]
[0m05:56:06.944325 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m05:56:06.945361 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:56:06.946141 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m05:56:06.947504 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:56:06.947990 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:56:06.948698 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:56:06.957227 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:56:06.968813 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:06.969266 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:56:06.972166 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:56:06.982235 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:56:06.982491 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m05:56:06.982705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:56:06.982905 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:08.193468 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
[0m05:56:08.194384 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m05:56:08.195058 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:56:08.362504 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m05:56:08.365546 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:08.366370 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m05:56:08.491282 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m05:56:08.493430 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.55s]
[0m05:56:08.495053 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m05:56:08.496174 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:56:08.497106 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m05:56:08.499029 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:56:08.499753 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:56:08.500499 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:56:08.507489 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:56:08.516588 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:08.516881 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:56:08.519352 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:56:08.529887 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:56:08.530248 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m05:56:08.530478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:56:08.530727 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:09.628362 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m05:56:09.629660 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m05:56:09.630772 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:56:09.747089 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m05:56:09.750422 [debug] [Thread-1  ]: finished collecting timing info
[0m05:56:09.751494 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m05:56:09.925227 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m05:56:09.927356 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.43s]
[0m05:56:09.928789 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m05:56:09.932486 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m05:56:09.933356 [debug] [MainThread]: Using redshift connection "master"
[0m05:56:09.934090 [debug] [MainThread]: On master: BEGIN
[0m05:56:09.934850 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:56:09.935685 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m05:56:11.322104 [debug] [MainThread]: SQL status: BEGIN in 1.39 seconds
[0m05:56:11.322777 [debug] [MainThread]: On master: COMMIT
[0m05:56:11.323301 [debug] [MainThread]: Using redshift connection "master"
[0m05:56:11.323625 [debug] [MainThread]: On master: COMMIT
[0m05:56:11.525107 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m05:56:11.526551 [debug] [MainThread]: On master: Close
[0m05:56:11.529187 [info ] [MainThread]: 
[0m05:56:11.530578 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 17.42 seconds (17.42s).
[0m05:56:11.531900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:56:11.532775 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m05:56:11.559873 [info ] [MainThread]: 
[0m05:56:11.560449 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:56:11.560966 [info ] [MainThread]: 
[0m05:56:11.561550 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m05:56:11.562110 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m05:56:11.562611 [info ] [MainThread]: 
[0m05:56:11.563096 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m05:56:11.563685 [info ] [MainThread]: 
[0m05:56:11.564164 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m05:56:11.564760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54612f2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54612f2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5461242610>]}
[0m05:56:11.565258 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 06:02:19.047915 | cef3bd7e-289b-49a7-9ce5-154c6850aa38 ==============================
[0m06:02:19.047927 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:02:19.048392 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m06:02:19.048643 [debug] [MainThread]: Tracking: tracking
[0m06:02:19.055524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace0ff880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace0ff940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace0ff970>]}
[0m06:02:19.197764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:02:19.198703 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/example/schema.yml
[0m06:02:19.210595 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m06:02:19.255588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef3bd7e-289b-49a7-9ce5-154c6850aa38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacc0feeb0>]}
[0m06:02:19.267882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef3bd7e-289b-49a7-9ce5-154c6850aa38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacc0c72b0>]}
[0m06:02:19.268190 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:02:19.268472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef3bd7e-289b-49a7-9ce5-154c6850aa38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacc0c7370>]}
[0m06:02:19.269859 [info ] [MainThread]: 
[0m06:02:19.270776 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:02:19.271885 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m06:02:19.280713 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:02:19.281120 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m06:02:19.281798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:19.282366 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:20.413099 [debug] [ThreadPool]: SQL status: BEGIN in 1.13 seconds
[0m06:02:20.413662 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:02:20.414166 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:02:20.539950 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m06:02:20.544332 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m06:02:20.655164 [debug] [ThreadPool]: On list_dev_public: Close
[0m06:02:20.663665 [debug] [MainThread]: Using redshift connection "master"
[0m06:02:20.664354 [debug] [MainThread]: On master: BEGIN
[0m06:02:20.664973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:20.665532 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:22.031243 [debug] [MainThread]: SQL status: BEGIN in 1.37 seconds
[0m06:02:22.032558 [debug] [MainThread]: Using redshift connection "master"
[0m06:02:22.033499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:02:22.219048 [debug] [MainThread]: SQL status: SELECT in 0.18 seconds
[0m06:02:22.222194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef3bd7e-289b-49a7-9ce5-154c6850aa38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacdfcf9d0>]}
[0m06:02:22.223276 [debug] [MainThread]: On master: ROLLBACK
[0m06:02:22.354243 [debug] [MainThread]: Using redshift connection "master"
[0m06:02:22.354955 [debug] [MainThread]: On master: BEGIN
[0m06:02:22.688080 [debug] [MainThread]: SQL status: BEGIN in 0.33 seconds
[0m06:02:22.688906 [debug] [MainThread]: On master: COMMIT
[0m06:02:22.689489 [debug] [MainThread]: Using redshift connection "master"
[0m06:02:22.690113 [debug] [MainThread]: On master: COMMIT
[0m06:02:23.198462 [debug] [MainThread]: SQL status: COMMIT in 0.51 seconds
[0m06:02:23.199694 [debug] [MainThread]: On master: Close
[0m06:02:23.202104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:02:23.203343 [info ] [MainThread]: 
[0m06:02:23.208077 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:02:23.208612 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_comissao ...................... [RUN]
[0m06:02:23.209564 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:02:23.209992 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:02:23.210510 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:02:23.215455 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:02:23.226097 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:23.226696 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:02:23.244510 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:02:23.254726 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:02:23.254995 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: BEGIN
[0m06:02:23.255314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:23.255899 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:24.497358 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
[0m06:02:24.498544 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:02:24.499555 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where comissao < 0


      
    ) dbt_internal_test
[0m06:02:28.428845 [debug] [Thread-1  ]: SQL status: SELECT in 3.93 seconds
[0m06:02:28.431547 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:28.432217 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: ROLLBACK
[0m06:02:28.627807 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: Close
[0m06:02:28.630109 [info ] [Thread-1  ]: 1 of 7 PASS nao_negativo_tb_10_compradores_comissao ............................ [[32mPASS[0m in 5.42s]
[0m06:02:28.631991 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:02:28.633123 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:02:28.634102 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m06:02:28.635974 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:02:28.636658 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:02:28.637775 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:02:28.648053 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:02:28.659746 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:28.660244 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:02:28.662828 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:02:28.671446 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:02:28.671787 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m06:02:28.672119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:28.672688 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:29.804586 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m06:02:29.805852 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:02:29.806908 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:02:30.002231 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m06:02:30.005495 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:30.006499 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m06:02:30.118389 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m06:02:30.120629 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.49s]
[0m06:02:30.122206 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:02:30.123098 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:02:30.124124 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m06:02:30.125725 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:02:30.126376 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:02:30.127095 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:02:30.134624 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:02:30.145590 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:30.145964 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:02:30.147912 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:02:30.154401 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:02:30.154675 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m06:02:30.154876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:30.155085 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:31.594018 [debug] [Thread-1  ]: SQL status: BEGIN in 1.44 seconds
[0m06:02:31.594598 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:02:31.595070 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:02:31.743658 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m06:02:31.747183 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:31.748193 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m06:02:31.872644 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m06:02:31.875055 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.75s]
[0m06:02:31.876728 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:02:31.877824 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:02:31.878711 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_comissao .......................... [RUN]
[0m06:02:31.880385 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:02:31.881163 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:02:31.882273 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:02:31.888131 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:02:31.898917 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:31.899429 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:02:31.901879 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:02:31.911549 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:02:31.911981 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: BEGIN
[0m06:02:31.912567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:31.913151 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:33.085147 [debug] [Thread-1  ]: SQL status: BEGIN in 1.17 seconds
[0m06:02:33.086256 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:02:33.087218 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."tb_10_compradores"
where comissao is null



      
    ) dbt_internal_test
[0m06:02:33.316632 [debug] [Thread-1  ]: SQL status: SELECT in 0.23 seconds
[0m06:02:33.320406 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:33.321426 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: ROLLBACK
[0m06:02:33.443267 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: Close
[0m06:02:33.445671 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_comissao ................................ [[32mPASS[0m in 1.57s]
[0m06:02:33.447186 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:02:33.448268 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m06:02:33.449136 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m06:02:33.451060 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:02:33.452017 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m06:02:33.452820 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m06:02:33.456268 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:02:33.465003 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:33.465425 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m06:02:33.467836 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:02:33.475357 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:02:33.475985 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m06:02:33.476384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:33.476829 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:34.712772 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
[0m06:02:34.714064 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:02:34.715102 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m06:02:34.830065 [debug] [Thread-1  ]: SQL status: SELECT in 0.11 seconds
[0m06:02:34.833610 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:34.834766 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m06:02:34.946203 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m06:02:34.948722 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.50s]
[0m06:02:34.950370 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m06:02:34.951290 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:02:34.952327 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m06:02:34.955067 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:02:34.955583 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:02:34.956217 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:02:34.964591 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:02:34.975979 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:34.976449 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:02:34.978418 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:02:34.986494 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:02:34.986826 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m06:02:34.987017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:34.987226 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:36.454759 [debug] [Thread-1  ]: SQL status: BEGIN in 1.47 seconds
[0m06:02:36.456081 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:02:36.457105 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:02:36.575197 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:02:36.578245 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:36.579472 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m06:02:36.761160 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m06:02:36.763449 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.81s]
[0m06:02:36.764884 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:02:36.765944 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:02:36.766858 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m06:02:36.768636 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:02:36.769423 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:02:36.770134 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:02:36.776083 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:02:36.785954 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:36.786352 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:02:36.790081 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:02:36.798474 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:02:36.798874 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m06:02:36.799172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.799455 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:38.361516 [debug] [Thread-1  ]: SQL status: BEGIN in 1.56 seconds
[0m06:02:38.362905 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:02:38.364120 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:02:38.491135 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:02:38.494963 [debug] [Thread-1  ]: finished collecting timing info
[0m06:02:38.496021 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m06:02:38.616774 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m06:02:38.618066 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.85s]
[0m06:02:38.619019 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:02:38.621155 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:02:38.621675 [debug] [MainThread]: Using redshift connection "master"
[0m06:02:38.622125 [debug] [MainThread]: On master: BEGIN
[0m06:02:38.622582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:38.623126 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:02:39.783687 [debug] [MainThread]: SQL status: BEGIN in 1.16 seconds
[0m06:02:39.784910 [debug] [MainThread]: On master: COMMIT
[0m06:02:39.785948 [debug] [MainThread]: Using redshift connection "master"
[0m06:02:39.786843 [debug] [MainThread]: On master: COMMIT
[0m06:02:39.908596 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m06:02:39.909795 [debug] [MainThread]: On master: Close
[0m06:02:39.912003 [info ] [MainThread]: 
[0m06:02:39.913065 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 20.64 seconds (20.64s).
[0m06:02:39.914066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:39.915020 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m06:02:39.937252 [info ] [MainThread]: 
[0m06:02:39.937720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:02:39.938270 [info ] [MainThread]: 
[0m06:02:39.938887 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m06:02:39.939759 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m06:02:39.940500 [info ] [MainThread]: 
[0m06:02:39.941830 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m06:02:39.943095 [info ] [MainThread]: 
[0m06:02:39.944207 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m06:02:39.945730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacc0837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacc083a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbacc083b50>]}
[0m06:02:39.946734 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 06:04:51.175773 | 94404318-7998-4a70-b20c-5a34488b586d ==============================
[0m06:04:51.175793 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:04:51.176464 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m06:04:51.176802 [debug] [MainThread]: Tracking: tracking
[0m06:04:51.184824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a3b8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a3b8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a3b8a60>]}
[0m06:04:51.356798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:04:51.357140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:04:51.361920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94404318-7998-4a70-b20c-5a34488b586d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a2c1eb0>]}
[0m06:04:51.372962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94404318-7998-4a70-b20c-5a34488b586d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a2e0940>]}
[0m06:04:51.373263 [info ] [MainThread]: Found 5 models, 7 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:04:51.373546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94404318-7998-4a70-b20c-5a34488b586d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a2e0a30>]}
[0m06:04:51.374796 [info ] [MainThread]: 
[0m06:04:51.375389 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:04:51.376609 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m06:04:51.386585 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:04:51.386857 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m06:04:51.387274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:04:51.387536 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:04:52.706887 [debug] [ThreadPool]: SQL status: BEGIN in 1.32 seconds
[0m06:04:52.707604 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:04:52.707971 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:04:52.869542 [debug] [ThreadPool]: SQL status: SELECT in 0.16 seconds
[0m06:04:52.871134 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m06:04:53.148567 [debug] [ThreadPool]: On list_dev_public: Close
[0m06:04:53.154536 [debug] [MainThread]: Using redshift connection "master"
[0m06:04:53.154836 [debug] [MainThread]: On master: BEGIN
[0m06:04:53.154997 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:04:53.155143 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:04:54.605564 [debug] [MainThread]: SQL status: BEGIN in 1.45 seconds
[0m06:04:54.606695 [debug] [MainThread]: Using redshift connection "master"
[0m06:04:54.607645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:04:54.761073 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m06:04:54.764220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94404318-7998-4a70-b20c-5a34488b586d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6a2e05b0>]}
[0m06:04:54.765371 [debug] [MainThread]: On master: ROLLBACK
[0m06:04:54.879590 [debug] [MainThread]: Using redshift connection "master"
[0m06:04:54.880742 [debug] [MainThread]: On master: BEGIN
[0m06:04:55.203988 [debug] [MainThread]: SQL status: BEGIN in 0.32 seconds
[0m06:04:55.205243 [debug] [MainThread]: On master: COMMIT
[0m06:04:55.206242 [debug] [MainThread]: Using redshift connection "master"
[0m06:04:55.207124 [debug] [MainThread]: On master: COMMIT
[0m06:04:55.412067 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m06:04:55.413470 [debug] [MainThread]: On master: Close
[0m06:04:55.415387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:04:55.416506 [info ] [MainThread]: 
[0m06:04:55.422207 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:04:55.423040 [info ] [Thread-1  ]: 1 of 7 START test nao_negativo_tb_10_compradores_comissao ...................... [RUN]
[0m06:04:55.424661 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:04:55.425203 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:04:55.425755 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:04:55.437845 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:04:55.450019 [debug] [Thread-1  ]: finished collecting timing info
[0m06:04:55.450453 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:04:55.462797 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:04:55.475420 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:04:55.475778 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: BEGIN
[0m06:04:55.476119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:04:55.476378 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:04:56.846252 [debug] [Thread-1  ]: SQL status: BEGIN in 1.37 seconds
[0m06:04:56.847296 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:04:56.848117 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where comissao < 0


      
    ) dbt_internal_test
[0m06:04:56.975979 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:04:56.980804 [debug] [Thread-1  ]: finished collecting timing info
[0m06:04:56.981616 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: ROLLBACK
[0m06:04:57.107483 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: Close
[0m06:04:57.109811 [info ] [Thread-1  ]: 1 of 7 PASS nao_negativo_tb_10_compradores_comissao ............................ [[32mPASS[0m in 1.69s]
[0m06:04:57.111650 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:04:57.112678 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:04:57.113560 [info ] [Thread-1  ]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m06:04:57.115422 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:04:57.116152 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:04:57.116859 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:04:57.127374 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:04:57.134909 [debug] [Thread-1  ]: finished collecting timing info
[0m06:04:57.135128 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:04:57.136641 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:04:57.145020 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:04:57.145290 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m06:04:57.145486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:04:57.145661 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:04:58.606307 [debug] [Thread-1  ]: SQL status: BEGIN in 1.46 seconds
[0m06:04:58.607495 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:04:58.608447 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:04:58.734265 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:04:58.737564 [debug] [Thread-1  ]: finished collecting timing info
[0m06:04:58.738518 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m06:04:58.865345 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m06:04:58.867835 [error] [Thread-1  ]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.75s]
[0m06:04:58.869324 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:04:58.870567 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:04:58.871759 [info ] [Thread-1  ]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m06:04:58.873564 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:04:58.874403 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:04:58.875145 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:04:58.881212 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:04:58.892875 [debug] [Thread-1  ]: finished collecting timing info
[0m06:04:58.893308 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:04:58.896954 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:04:58.905547 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:04:58.906098 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m06:04:58.906389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:04:58.906845 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:05:00.263330 [debug] [Thread-1  ]: SQL status: BEGIN in 1.36 seconds
[0m06:05:00.264085 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:05:00.264698 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:05:00.429954 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m06:05:00.433522 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:00.434588 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m06:05:00.577482 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m06:05:00.579884 [info ] [Thread-1  ]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.71s]
[0m06:05:00.581476 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:05:00.582658 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:05:00.583605 [info ] [Thread-1  ]: 4 of 7 START test not_null_tb_10_compradores_comissao .......................... [RUN]
[0m06:05:00.585404 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:05:00.586240 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:05:00.586961 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:05:00.594753 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:05:00.604366 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:00.604757 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:05:00.607616 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:05:00.614955 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:05:00.615326 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: BEGIN
[0m06:05:00.615583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:05:00.615788 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:05:02.002879 [debug] [Thread-1  ]: SQL status: BEGIN in 1.39 seconds
[0m06:05:02.003540 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:05:02.003910 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."tb_10_compradores"
where comissao is null



      
    ) dbt_internal_test
[0m06:05:02.113316 [debug] [Thread-1  ]: SQL status: SELECT in 0.11 seconds
[0m06:05:02.115080 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:02.115735 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: ROLLBACK
[0m06:05:02.273061 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: Close
[0m06:05:02.274375 [info ] [Thread-1  ]: 4 of 7 PASS not_null_tb_10_compradores_comissao ................................ [[32mPASS[0m in 1.69s]
[0m06:05:02.275444 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:05:02.276018 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m06:05:02.276545 [info ] [Thread-1  ]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m06:05:02.277504 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:05:02.277931 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m06:05:02.278388 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m06:05:02.280634 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:05:02.292443 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:02.292892 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m06:05:02.295185 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:05:02.301874 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:05:02.302288 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m06:05:02.302847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:05:02.303376 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:05:03.714070 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m06:05:03.715248 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:05:03.716131 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m06:05:03.913364 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m06:05:03.916409 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:03.917003 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m06:05:04.116062 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m06:05:04.118356 [info ] [Thread-1  ]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.84s]
[0m06:05:04.119841 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m06:05:04.120830 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:05:04.121854 [info ] [Thread-1  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m06:05:04.123602 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:05:04.124311 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:05:04.125209 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:05:04.134891 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:05:04.146162 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:04.146599 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:05:04.148626 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:05:04.159749 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:05:04.160220 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m06:05:04.160579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:05:04.160863 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:05:05.551257 [debug] [Thread-1  ]: SQL status: BEGIN in 1.39 seconds
[0m06:05:05.552533 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:05:05.553654 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:05:05.685063 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:05:05.688529 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:05.689528 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m06:05:05.817437 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m06:05:05.818858 [info ] [Thread-1  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.70s]
[0m06:05:05.819976 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:05:05.820747 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:05:05.821397 [info ] [Thread-1  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m06:05:05.822555 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:05:05.823042 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:05:05.823493 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:05:05.828393 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:05:05.840440 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:05.841128 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:05:05.843788 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:05:05.851273 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:05:05.851480 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m06:05:05.851664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:05:05.852102 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:05:07.307872 [debug] [Thread-1  ]: SQL status: BEGIN in 1.46 seconds
[0m06:05:07.308608 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:05:07.309191 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:05:07.501712 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m06:05:07.503541 [debug] [Thread-1  ]: finished collecting timing info
[0m06:05:07.504070 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m06:05:07.698262 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m06:05:07.699483 [info ] [Thread-1  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.88s]
[0m06:05:07.700350 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:05:07.702374 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:05:07.702858 [debug] [MainThread]: Using redshift connection "master"
[0m06:05:07.703296 [debug] [MainThread]: On master: BEGIN
[0m06:05:07.703742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:05:07.704095 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:05:09.167670 [debug] [MainThread]: SQL status: BEGIN in 1.46 seconds
[0m06:05:09.168610 [debug] [MainThread]: On master: COMMIT
[0m06:05:09.169415 [debug] [MainThread]: Using redshift connection "master"
[0m06:05:09.170217 [debug] [MainThread]: On master: COMMIT
[0m06:05:09.301999 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m06:05:09.303246 [debug] [MainThread]: On master: Close
[0m06:05:09.305434 [info ] [MainThread]: 
[0m06:05:09.306614 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 17.93 seconds (17.93s).
[0m06:05:09.307561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:05:09.308409 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m06:05:09.331639 [info ] [MainThread]: 
[0m06:05:09.332218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:05:09.332991 [info ] [MainThread]: 
[0m06:05:09.333526 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m06:05:09.334082 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m06:05:09.334575 [info ] [MainThread]: 
[0m06:05:09.335048 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m06:05:09.335510 [info ] [MainThread]: 
[0m06:05:09.335997 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m06:05:09.336573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e699dffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e6e8972e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e681286a0>]}
[0m06:05:09.337042 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 06:05:48.097861 | 8069b73c-a582-46e3-9ef0-b97572f8a98e ==============================
[0m06:05:48.097873 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:05:48.098520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:05:48.099033 [debug] [MainThread]: Tracking: tracking
[0m06:05:48.105738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cab3e2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cab3e2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cab3e2a30>]}
[0m06:05:48.243644 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:05:48.244111 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/schema.yml
[0m06:05:48.255314 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m06:05:48.264143 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:05:48.266174 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:05:48.275723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cab2ac130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cab26e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cab2a5340>]}
[0m06:05:48.276252 [debug] [MainThread]: Flushing usage events
[0m06:05:48.972613 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named tb_10_compradores. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for tb_10_compradores in this file:
   - models/schema.yml
  


============================== 2022-12-03 06:07:24.430776 | 00590785-4746-45de-a0da-8750caa378f2 ==============================
[0m06:07:24.430789 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:07:24.431502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m06:07:24.432001 [debug] [MainThread]: Tracking: tracking
[0m06:07:24.438543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141cba4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141cba49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141cba4a00>]}
[0m06:07:24.576881 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:07:24.577411 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models/schema.yml
[0m06:07:24.589262 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m06:07:24.598533 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m06:07:24.600569 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m06:07:24.649254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00590785-4746-45de-a0da-8750caa378f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c1a06a0>]}
[0m06:07:24.662298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00590785-4746-45de-a0da-8750caa378f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c177dc0>]}
[0m06:07:24.662617 [info ] [MainThread]: Found 5 models, 9 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:07:24.662897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00590785-4746-45de-a0da-8750caa378f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c9fc1f0>]}
[0m06:07:24.664324 [info ] [MainThread]: 
[0m06:07:24.665484 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:07:24.666774 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m06:07:24.675870 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:07:24.676502 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m06:07:24.677027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:24.677592 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:26.351016 [debug] [ThreadPool]: SQL status: BEGIN in 1.67 seconds
[0m06:07:26.351540 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:07:26.351856 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:07:26.569173 [debug] [ThreadPool]: SQL status: SELECT in 0.22 seconds
[0m06:07:26.573052 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m06:07:26.831241 [debug] [ThreadPool]: On list_dev_public: Close
[0m06:07:26.842675 [debug] [MainThread]: Using redshift connection "master"
[0m06:07:26.843198 [debug] [MainThread]: On master: BEGIN
[0m06:07:26.843651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:07:26.844099 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:28.114500 [debug] [MainThread]: SQL status: BEGIN in 1.27 seconds
[0m06:07:28.115710 [debug] [MainThread]: Using redshift connection "master"
[0m06:07:28.116699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:07:28.274939 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m06:07:28.278625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00590785-4746-45de-a0da-8750caa378f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c9f6f70>]}
[0m06:07:28.279920 [debug] [MainThread]: On master: ROLLBACK
[0m06:07:28.389168 [debug] [MainThread]: Using redshift connection "master"
[0m06:07:28.390428 [debug] [MainThread]: On master: BEGIN
[0m06:07:28.609619 [debug] [MainThread]: SQL status: BEGIN in 0.22 seconds
[0m06:07:28.610804 [debug] [MainThread]: On master: COMMIT
[0m06:07:28.611734 [debug] [MainThread]: Using redshift connection "master"
[0m06:07:28.612594 [debug] [MainThread]: On master: COMMIT
[0m06:07:28.809790 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m06:07:28.811119 [debug] [MainThread]: On master: Close
[0m06:07:28.813442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:07:28.814748 [info ] [MainThread]: 
[0m06:07:28.821285 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:07:28.821926 [info ] [Thread-1  ]: 1 of 9 START test nao_negativo_tb_10_compradores_comissao ...................... [RUN]
[0m06:07:28.822966 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:07:28.823500 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:07:28.824023 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:07:28.830135 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:07:28.845437 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:28.845951 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:07:28.862216 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:07:28.870559 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:07:28.870754 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: BEGIN
[0m06:07:28.870955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:28.871137 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:29.948407 [debug] [Thread-1  ]: SQL status: BEGIN in 1.08 seconds
[0m06:07:29.949567 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:07:29.950701 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where comissao < 0


      
    ) dbt_internal_test
[0m06:07:30.141231 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m06:07:30.145874 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:30.146858 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: ROLLBACK
[0m06:07:30.255400 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: Close
[0m06:07:30.256869 [info ] [Thread-1  ]: 1 of 9 PASS nao_negativo_tb_10_compradores_comissao ............................ [[32mPASS[0m in 1.43s]
[0m06:07:30.257918 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:07:30.258561 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:07:30.259160 [info ] [Thread-1  ]: 2 of 9 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m06:07:30.260253 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:07:30.260675 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:07:30.261158 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:07:30.266736 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:07:30.281204 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:30.281627 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:07:30.283580 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:07:30.290967 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:07:30.291456 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m06:07:30.291747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:30.292100 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:31.927742 [debug] [Thread-1  ]: SQL status: BEGIN in 1.64 seconds
[0m06:07:31.928284 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:07:31.928673 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m06:07:32.043885 [debug] [Thread-1  ]: SQL status: SELECT in 0.11 seconds
[0m06:07:32.045974 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:32.046638 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m06:07:32.159459 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m06:07:32.160584 [info ] [Thread-1  ]: 2 of 9 PASS nao_negativo_tb_10_compradores_vendas_totais ....................... [[32mPASS[0m in 1.90s]
[0m06:07:32.161331 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:07:32.162130 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:07:32.162721 [info ] [Thread-1  ]: 3 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m06:07:32.163773 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:07:32.164447 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:07:32.165106 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:07:32.170724 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:07:32.183224 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:32.183825 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:07:32.185988 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:07:32.195894 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:07:32.196457 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m06:07:32.196890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:32.197304 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:33.734675 [debug] [Thread-1  ]: SQL status: BEGIN in 1.54 seconds
[0m06:07:33.735981 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m06:07:33.736942 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:07:33.880694 [debug] [Thread-1  ]: SQL status: SELECT in 0.14 seconds
[0m06:07:33.884277 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:33.885298 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m06:07:34.025827 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m06:07:34.028371 [error] [Thread-1  ]: 3 of 9 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.86s]
[0m06:07:34.030303 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m06:07:34.031433 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:07:34.032383 [info ] [Thread-1  ]: 4 of 9 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m06:07:34.034279 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:07:34.034996 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:07:34.035725 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:07:34.043305 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:07:34.051842 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:34.052102 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:07:34.053814 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:07:34.061587 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:07:34.061857 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m06:07:34.062080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:34.062328 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:35.109315 [debug] [Thread-1  ]: SQL status: BEGIN in 1.05 seconds
[0m06:07:35.110015 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m06:07:35.110583 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m06:07:35.235555 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:07:35.238499 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:35.239362 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m06:07:35.356939 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m06:07:35.359200 [info ] [Thread-1  ]: 4 of 9 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.33s]
[0m06:07:35.360671 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m06:07:35.361639 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:07:35.362630 [info ] [Thread-1  ]: 5 of 9 START test not_null_tb_10_compradores_comissao .......................... [RUN]
[0m06:07:35.364514 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:07:35.365234 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:07:35.366107 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:07:35.374314 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:07:35.382624 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:35.382918 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:07:35.385226 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:07:35.395673 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:07:35.396115 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: BEGIN
[0m06:07:35.396456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:35.396741 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:36.669945 [debug] [Thread-1  ]: SQL status: BEGIN in 1.27 seconds
[0m06:07:36.671096 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:07:36.672156 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."tb_10_compradores"
where comissao is null



      
    ) dbt_internal_test
[0m06:07:36.797231 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:07:36.800655 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:36.801874 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: ROLLBACK
[0m06:07:37.002203 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: Close
[0m06:07:37.004533 [info ] [Thread-1  ]: 5 of 9 PASS not_null_tb_10_compradores_comissao ................................ [[32mPASS[0m in 1.64s]
[0m06:07:37.006135 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:07:37.007214 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:07:37.008299 [info ] [Thread-1  ]: 6 of 9 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m06:07:37.010064 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:07:37.010622 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:07:37.011175 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:07:37.017859 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:07:37.028137 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:37.028535 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:07:37.032252 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:07:37.039999 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:07:37.040460 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m06:07:37.040893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:37.041420 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:38.245421 [debug] [Thread-1  ]: SQL status: BEGIN in 1.2 seconds
[0m06:07:38.246656 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:07:38.247703 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m06:07:38.366752 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:07:38.368702 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:38.369338 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m06:07:38.485185 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m06:07:38.487379 [info ] [Thread-1  ]: 6 of 9 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.48s]
[0m06:07:38.488931 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:07:38.490054 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m06:07:38.490977 [info ] [Thread-1  ]: 7 of 9 START test test_singular_nao_negativo ................................... [RUN]
[0m06:07:38.492782 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:07:38.493743 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m06:07:38.494532 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m06:07:38.497841 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:07:38.507026 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:38.507534 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m06:07:38.510096 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:07:38.517369 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:07:38.517724 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m06:07:38.517958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:38.518195 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:40.004186 [debug] [Thread-1  ]: SQL status: BEGIN in 1.49 seconds
[0m06:07:40.005431 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:07:40.006355 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m06:07:40.176685 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m06:07:40.178939 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:40.179552 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m06:07:40.316358 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m06:07:40.318864 [info ] [Thread-1  ]: 7 of 9 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.83s]
[0m06:07:40.320689 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m06:07:40.321896 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:07:40.322944 [info ] [Thread-1  ]: 8 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m06:07:40.324764 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:07:40.325531 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:07:40.326366 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:07:40.335698 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:07:40.345566 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:40.345999 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:07:40.348464 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:07:40.354602 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:07:40.354848 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m06:07:40.355118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:40.355716 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:41.765099 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m06:07:41.766289 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m06:07:41.767286 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:07:41.918935 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m06:07:41.922535 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:41.923471 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m06:07:42.124340 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m06:07:42.127080 [info ] [Thread-1  ]: 8 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.80s]
[0m06:07:42.128786 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m06:07:42.129909 [debug] [Thread-1  ]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:07:42.131036 [info ] [Thread-1  ]: 9 of 9 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m06:07:42.132755 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:07:42.133407 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:07:42.134148 [debug] [Thread-1  ]: Compiling test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:07:42.139905 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:07:42.149454 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:42.149760 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:07:42.151483 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:07:42.158944 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:07:42.159402 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m06:07:42.159830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:42.160224 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:44.319494 [debug] [Thread-1  ]: SQL status: BEGIN in 2.16 seconds
[0m06:07:44.320746 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m06:07:44.321958 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m06:07:44.451571 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:07:44.455114 [debug] [Thread-1  ]: finished collecting timing info
[0m06:07:44.456171 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m06:07:44.593191 [debug] [Thread-1  ]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m06:07:44.595390 [info ] [Thread-1  ]: 9 of 9 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 2.46s]
[0m06:07:44.596841 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m06:07:44.600528 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:07:44.601380 [debug] [MainThread]: Using redshift connection "master"
[0m06:07:44.602113 [debug] [MainThread]: On master: BEGIN
[0m06:07:44.602738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:44.603364 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:07:48.959789 [debug] [MainThread]: SQL status: BEGIN in 4.36 seconds
[0m06:07:48.961431 [debug] [MainThread]: On master: COMMIT
[0m06:07:48.962551 [debug] [MainThread]: Using redshift connection "master"
[0m06:07:48.963666 [debug] [MainThread]: On master: COMMIT
[0m06:07:49.074762 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m06:07:49.076035 [debug] [MainThread]: On master: Close
[0m06:07:49.078329 [info ] [MainThread]: 
[0m06:07:49.079674 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 24.41 seconds (24.41s).
[0m06:07:49.080977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:49.082010 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m06:07:49.104214 [info ] [MainThread]: 
[0m06:07:49.104782 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:07:49.105382 [info ] [MainThread]: 
[0m06:07:49.106090 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/schema.yml)[0m
[0m06:07:49.107230 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m06:07:49.108193 [info ] [MainThread]: 
[0m06:07:49.108872 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/schema.yml/not_null_my_first_dbt_model_id.sql
[0m06:07:49.109454 [info ] [MainThread]: 
[0m06:07:49.109963 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m06:07:49.110594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c9fc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c9fc1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f141c10fd60>]}
[0m06:07:49.111086 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 06:08:31.589639 | 95eb4ad6-861e-49f3-a143-b49974acf3c1 ==============================
[0m06:08:31.589654 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:08:31.590308 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m06:08:31.590790 [debug] [MainThread]: Tracking: tracking
[0m06:08:31.597982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a7a28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a7a29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a7a29d0>]}
[0m06:08:31.723185 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m06:08:31.723805 [debug] [MainThread]: Partial parsing: update schema file: analytics_dbt://models/schema.yml
[0m06:08:31.724261 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://models/example/my_second_dbt_model.sql
[0m06:08:31.724521 [debug] [MainThread]: Partial parsing: deleted file: analytics_dbt://models/example/my_first_dbt_model.sql
[0m06:08:31.742338 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.example

[0m06:08:31.747144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95eb4ad6-861e-49f3-a143-b49974acf3c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a6738e0>]}
[0m06:08:31.761371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95eb4ad6-861e-49f3-a143-b49974acf3c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a63b190>]}
[0m06:08:31.761747 [info ] [MainThread]: Found 3 models, 5 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:08:31.762258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95eb4ad6-861e-49f3-a143-b49974acf3c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a63b1c0>]}
[0m06:08:31.763763 [info ] [MainThread]: 
[0m06:08:31.764502 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:08:31.765783 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m06:08:31.774757 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:08:31.775381 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m06:08:31.775949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:31.776364 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:33.035474 [debug] [ThreadPool]: SQL status: BEGIN in 1.26 seconds
[0m06:08:33.036558 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:08:33.037559 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:08:33.168305 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m06:08:33.172441 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m06:08:33.288596 [debug] [ThreadPool]: On list_dev_public: Close
[0m06:08:33.299530 [debug] [MainThread]: Using redshift connection "master"
[0m06:08:33.300213 [debug] [MainThread]: On master: BEGIN
[0m06:08:33.300865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:08:33.301485 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:34.499363 [debug] [MainThread]: SQL status: BEGIN in 1.2 seconds
[0m06:08:34.500406 [debug] [MainThread]: Using redshift connection "master"
[0m06:08:34.501313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:08:34.665290 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m06:08:34.668351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95eb4ad6-861e-49f3-a143-b49974acf3c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb32a68c970>]}
[0m06:08:34.669538 [debug] [MainThread]: On master: ROLLBACK
[0m06:08:34.793238 [debug] [MainThread]: Using redshift connection "master"
[0m06:08:34.794698 [debug] [MainThread]: On master: BEGIN
[0m06:08:35.046051 [debug] [MainThread]: SQL status: BEGIN in 0.25 seconds
[0m06:08:35.047605 [debug] [MainThread]: On master: COMMIT
[0m06:08:35.048735 [debug] [MainThread]: Using redshift connection "master"
[0m06:08:35.049736 [debug] [MainThread]: On master: COMMIT
[0m06:08:35.173437 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m06:08:35.174723 [debug] [MainThread]: On master: Close
[0m06:08:35.177056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:08:35.178529 [info ] [MainThread]: 
[0m06:08:35.185777 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:08:35.186602 [info ] [Thread-1  ]: 1 of 5 START test nao_negativo_tb_10_compradores_comissao ...................... [RUN]
[0m06:08:35.187862 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:08:35.188436 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:08:35.188957 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:08:35.197575 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:08:35.205764 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:35.206524 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:08:35.219941 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:08:35.229191 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:08:35.229619 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: BEGIN
[0m06:08:35.229874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:08:35.230317 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:36.297348 [debug] [Thread-1  ]: SQL status: BEGIN in 1.07 seconds
[0m06:08:36.297944 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:08:36.298468 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where comissao < 0


      
    ) dbt_internal_test
[0m06:08:36.413928 [debug] [Thread-1  ]: SQL status: SELECT in 0.11 seconds
[0m06:08:36.418516 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:36.419514 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: ROLLBACK
[0m06:08:36.532312 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: Close
[0m06:08:36.534610 [info ] [Thread-1  ]: 1 of 5 PASS nao_negativo_tb_10_compradores_comissao ............................ [[32mPASS[0m in 1.35s]
[0m06:08:36.536260 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:08:36.537355 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:08:36.538315 [info ] [Thread-1  ]: 2 of 5 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m06:08:36.540491 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:08:36.541417 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:08:36.542154 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:08:36.548831 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:08:36.560187 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:36.560799 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:08:36.563723 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:08:36.571615 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:08:36.571894 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m06:08:36.572406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:08:36.572849 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:38.032972 [debug] [Thread-1  ]: SQL status: BEGIN in 1.46 seconds
[0m06:08:38.033716 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:08:38.034455 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m06:08:38.164550 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:08:38.166409 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:38.166780 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m06:08:38.326118 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m06:08:38.328534 [info ] [Thread-1  ]: 2 of 5 PASS nao_negativo_tb_10_compradores_vendas_totais ....................... [[32mPASS[0m in 1.79s]
[0m06:08:38.329913 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:08:38.330888 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:08:38.331728 [info ] [Thread-1  ]: 3 of 5 START test not_null_tb_10_compradores_comissao .......................... [RUN]
[0m06:08:38.333254 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:08:38.333952 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:08:38.334433 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:08:38.340889 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:08:38.349320 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:38.349649 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:08:38.351398 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:08:38.359653 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:08:38.359947 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: BEGIN
[0m06:08:38.360185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:08:38.360407 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:39.575698 [debug] [Thread-1  ]: SQL status: BEGIN in 1.22 seconds
[0m06:08:39.576541 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:08:39.577311 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."tb_10_compradores"
where comissao is null



      
    ) dbt_internal_test
[0m06:08:39.689477 [debug] [Thread-1  ]: SQL status: SELECT in 0.11 seconds
[0m06:08:39.692895 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:39.693764 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: ROLLBACK
[0m06:08:39.878323 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: Close
[0m06:08:39.880764 [info ] [Thread-1  ]: 3 of 5 PASS not_null_tb_10_compradores_comissao ................................ [[32mPASS[0m in 1.55s]
[0m06:08:39.882336 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:08:39.883526 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:08:39.884434 [info ] [Thread-1  ]: 4 of 5 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m06:08:39.886286 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:08:39.887056 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:08:39.887719 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:08:39.893740 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:08:39.903236 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:39.903612 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:08:39.906104 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:08:39.915612 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:08:39.916001 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m06:08:39.916253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:08:39.916533 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:41.156879 [debug] [Thread-1  ]: SQL status: BEGIN in 1.24 seconds
[0m06:08:41.157462 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:08:41.157945 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m06:08:41.338874 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m06:08:41.342050 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:41.342683 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m06:08:41.461189 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m06:08:41.463622 [info ] [Thread-1  ]: 4 of 5 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.58s]
[0m06:08:41.465159 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:08:41.466124 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m06:08:41.466957 [info ] [Thread-1  ]: 5 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m06:08:41.468615 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:08:41.469312 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m06:08:41.469975 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m06:08:41.473272 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:08:41.481467 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:41.481913 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m06:08:41.485401 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:08:41.491878 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:08:41.492260 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m06:08:41.492606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:08:41.492913 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:42.869983 [debug] [Thread-1  ]: SQL status: BEGIN in 1.38 seconds
[0m06:08:42.871250 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:08:42.872288 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m06:08:43.052095 [debug] [Thread-1  ]: SQL status: SELECT in 0.18 seconds
[0m06:08:43.055500 [debug] [Thread-1  ]: finished collecting timing info
[0m06:08:43.056511 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m06:08:43.256089 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m06:08:43.257489 [info ] [Thread-1  ]: 5 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.79s]
[0m06:08:43.258414 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m06:08:43.260759 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:08:43.261198 [debug] [MainThread]: Using redshift connection "master"
[0m06:08:43.261633 [debug] [MainThread]: On master: BEGIN
[0m06:08:43.262027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:08:43.262506 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:08:44.851111 [debug] [MainThread]: SQL status: BEGIN in 1.59 seconds
[0m06:08:44.852306 [debug] [MainThread]: On master: COMMIT
[0m06:08:44.853286 [debug] [MainThread]: Using redshift connection "master"
[0m06:08:44.854081 [debug] [MainThread]: On master: COMMIT
[0m06:08:44.978878 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m06:08:44.980057 [debug] [MainThread]: On master: Close
[0m06:08:44.982218 [info ] [MainThread]: 
[0m06:08:44.983364 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 13.22 seconds (13.22s).
[0m06:08:44.984464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:44.985159 [debug] [MainThread]: Connection 'test.analytics_dbt.test_singular_nao_negativo' was properly closed.
[0m06:08:45.006177 [info ] [MainThread]: 
[0m06:08:45.006898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:45.008139 [info ] [MainThread]: 
[0m06:08:45.009087 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:08:45.010144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284d81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284d86a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284d8190>]}
[0m06:08:45.010956 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 06:11:43.396499 | c3d30b61-f0a8-49f6-a4e2-b8faf0bced52 ==============================
[0m06:11:43.396514 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:11:43.397161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m06:11:43.397819 [debug] [MainThread]: Tracking: tracking
[0m06:11:43.405278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8749480970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8749480a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8749480a60>]}
[0m06:11:43.526682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:11:43.527307 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://macros/test_nao_negativo.sql
[0m06:11:43.527605 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
[0m06:11:43.540207 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m06:11:43.586645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.example

[0m06:11:43.591732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3d30b61-f0a8-49f6-a4e2-b8faf0bced52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87480bde20>]}
[0m06:11:43.604993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3d30b61-f0a8-49f6-a4e2-b8faf0bced52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87480ab550>]}
[0m06:11:43.605713 [info ] [MainThread]: Found 3 models, 5 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:11:43.606498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3d30b61-f0a8-49f6-a4e2-b8faf0bced52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87480ab580>]}
[0m06:11:43.608265 [info ] [MainThread]: 
[0m06:11:43.609450 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:11:43.611043 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m06:11:43.620778 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:11:43.621142 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m06:11:43.621347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:43.621645 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:11:45.044290 [debug] [ThreadPool]: SQL status: BEGIN in 1.42 seconds
[0m06:11:45.045082 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:11:45.045640 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:11:45.189075 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
[0m06:11:45.192046 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m06:11:45.327094 [debug] [ThreadPool]: On list_dev_public: Close
[0m06:11:45.335698 [debug] [MainThread]: Using redshift connection "master"
[0m06:11:45.336275 [debug] [MainThread]: On master: BEGIN
[0m06:11:45.336852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:11:45.337570 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:11:46.556833 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
[0m06:11:46.558397 [debug] [MainThread]: Using redshift connection "master"
[0m06:11:46.559478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:11:46.709929 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m06:11:46.712285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3d30b61-f0a8-49f6-a4e2-b8faf0bced52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87480c5f70>]}
[0m06:11:46.713247 [debug] [MainThread]: On master: ROLLBACK
[0m06:11:46.823648 [debug] [MainThread]: Using redshift connection "master"
[0m06:11:46.824915 [debug] [MainThread]: On master: BEGIN
[0m06:11:47.044976 [debug] [MainThread]: SQL status: BEGIN in 0.22 seconds
[0m06:11:47.045827 [debug] [MainThread]: On master: COMMIT
[0m06:11:47.046578 [debug] [MainThread]: Using redshift connection "master"
[0m06:11:47.047103 [debug] [MainThread]: On master: COMMIT
[0m06:11:47.156865 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m06:11:47.158039 [debug] [MainThread]: On master: Close
[0m06:11:47.159424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:11:47.159907 [info ] [MainThread]: 
[0m06:11:47.162871 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:11:47.163344 [info ] [Thread-1  ]: 1 of 5 START test nao_negativo_tb_10_compradores_comissao ...................... [RUN]
[0m06:11:47.164120 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:11:47.164522 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:11:47.165019 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:11:47.169247 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:11:47.180149 [debug] [Thread-1  ]: finished collecting timing info
[0m06:11:47.180615 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:11:47.192601 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:11:47.199916 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:11:47.200157 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: BEGIN
[0m06:11:47.200373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:11:47.200569 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:11:48.808238 [debug] [Thread-1  ]: SQL status: BEGIN in 1.61 seconds
[0m06:11:48.809469 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:11:48.810402 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where comissao > 0


      
    ) dbt_internal_test
[0m06:11:52.777502 [debug] [Thread-1  ]: SQL status: SELECT in 3.97 seconds
[0m06:11:52.781242 [debug] [Thread-1  ]: finished collecting timing info
[0m06:11:52.781934 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: ROLLBACK
[0m06:11:52.915182 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: Close
[0m06:11:52.917366 [error] [Thread-1  ]: 1 of 5 FAIL 10 nao_negativo_tb_10_compradores_comissao ......................... [[31mFAIL 10[0m in 5.75s]
[0m06:11:52.918721 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:11:52.919571 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:11:52.920307 [info ] [Thread-1  ]: 2 of 5 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m06:11:52.921651 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:11:52.922083 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:11:52.922565 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:11:52.927668 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:11:52.935343 [debug] [Thread-1  ]: finished collecting timing info
[0m06:11:52.935756 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:11:52.939405 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:11:52.947615 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:11:52.947992 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m06:11:52.948229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:11:52.948488 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:11:55.258925 [debug] [Thread-1  ]: SQL status: BEGIN in 2.31 seconds
[0m06:11:55.259669 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:11:55.260220 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where vendas_totais > 0


      
    ) dbt_internal_test
[0m06:11:59.164494 [debug] [Thread-1  ]: SQL status: SELECT in 3.9 seconds
[0m06:11:59.168044 [debug] [Thread-1  ]: finished collecting timing info
[0m06:11:59.169216 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m06:11:59.359306 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m06:11:59.361626 [error] [Thread-1  ]: 2 of 5 FAIL 10 nao_negativo_tb_10_compradores_vendas_totais .................... [[31mFAIL 10[0m in 6.44s]
[0m06:11:59.362986 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:11:59.363868 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:11:59.364587 [info ] [Thread-1  ]: 3 of 5 START test not_null_tb_10_compradores_comissao .......................... [RUN]
[0m06:11:59.365777 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:11:59.366249 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:11:59.366774 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:11:59.376210 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:11:59.384584 [debug] [Thread-1  ]: finished collecting timing info
[0m06:11:59.384878 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:11:59.387177 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:11:59.396706 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:11:59.397107 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: BEGIN
[0m06:11:59.397446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:11:59.397778 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:01.417364 [debug] [Thread-1  ]: SQL status: BEGIN in 2.02 seconds
[0m06:12:01.418838 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:12:01.419906 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."tb_10_compradores"
where comissao is null



      
    ) dbt_internal_test
[0m06:12:01.553350 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:12:01.556962 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:01.558004 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: ROLLBACK
[0m06:12:01.722160 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: Close
[0m06:12:01.724568 [info ] [Thread-1  ]: 3 of 5 PASS not_null_tb_10_compradores_comissao ................................ [[32mPASS[0m in 2.36s]
[0m06:12:01.726586 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:12:01.727854 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:12:01.728837 [info ] [Thread-1  ]: 4 of 5 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m06:12:01.730554 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:12:01.731284 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:12:01.731906 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:12:01.737707 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:12:01.748342 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:01.748791 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:12:01.751360 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:12:01.761705 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:12:01.762425 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m06:12:01.762862 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:12:01.763246 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:03.174042 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m06:12:03.175308 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:12:03.176286 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m06:12:03.292460 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:12:03.295482 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:03.296382 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m06:12:03.424650 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m06:12:03.427241 [info ] [Thread-1  ]: 4 of 5 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.70s]
[0m06:12:03.428905 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:12:03.430014 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m06:12:03.431008 [info ] [Thread-1  ]: 5 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m06:12:03.432830 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:12:03.433602 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m06:12:03.434482 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m06:12:03.438090 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:12:03.447688 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:03.448181 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m06:12:03.450303 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:12:03.456677 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:12:03.457490 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m06:12:03.458193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:12:03.458546 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:04.887249 [debug] [Thread-1  ]: SQL status: BEGIN in 1.43 seconds
[0m06:12:04.888569 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:12:04.889572 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m06:12:05.092335 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m06:12:05.094782 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:05.095536 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m06:12:05.296978 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m06:12:05.299292 [info ] [Thread-1  ]: 5 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.87s]
[0m06:12:05.300762 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m06:12:05.303464 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:12:05.304067 [debug] [MainThread]: Using redshift connection "master"
[0m06:12:05.304521 [debug] [MainThread]: On master: BEGIN
[0m06:12:05.305024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:12:05.305545 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:07.710061 [debug] [MainThread]: SQL status: BEGIN in 2.41 seconds
[0m06:12:07.711007 [debug] [MainThread]: On master: COMMIT
[0m06:12:07.711805 [debug] [MainThread]: Using redshift connection "master"
[0m06:12:07.712412 [debug] [MainThread]: On master: COMMIT
[0m06:12:07.839970 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m06:12:07.841044 [debug] [MainThread]: On master: Close
[0m06:12:07.842328 [info ] [MainThread]: 
[0m06:12:07.842858 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 24.23 seconds (24.23s).
[0m06:12:07.843655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:12:07.844171 [debug] [MainThread]: Connection 'test.analytics_dbt.test_singular_nao_negativo' was properly closed.
[0m06:12:07.862732 [info ] [MainThread]: 
[0m06:12:07.863137 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:12:07.863533 [info ] [MainThread]: 
[0m06:12:07.863968 [error] [MainThread]: [31mFailure in test nao_negativo_tb_10_compradores_comissao (models/schema.yml)[0m
[0m06:12:07.864530 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m06:12:07.864993 [info ] [MainThread]: 
[0m06:12:07.865359 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/schema.yml/nao_negativo_tb_10_compradores_comissao.sql
[0m06:12:07.865904 [info ] [MainThread]: 
[0m06:12:07.866670 [error] [MainThread]: [31mFailure in test nao_negativo_tb_10_compradores_vendas_totais (models/schema.yml)[0m
[0m06:12:07.867294 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m06:12:07.867762 [info ] [MainThread]: 
[0m06:12:07.868278 [info ] [MainThread]:   compiled Code at target/compiled/analytics_dbt/models/schema.yml/nao_negativo_tb_10_compradores_vendas_totais.sql
[0m06:12:07.868889 [info ] [MainThread]: 
[0m06:12:07.869287 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m06:12:07.869790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87480785e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8748078880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f874808bac0>]}
[0m06:12:07.870217 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 06:12:50.319011 | 3327415f-a3a8-4565-82e7-fa294ef477aa ==============================
[0m06:12:50.319024 [info ] [MainThread]: Running with dbt=1.3.1
[0m06:12:50.319481 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m06:12:50.319846 [debug] [MainThread]: Tracking: tracking
[0m06:12:50.326869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce13ef79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce13ef7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce13ef7a90>]}
[0m06:12:50.441889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:12:50.442447 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://macros/test_nao_negativo.sql
[0m06:12:50.442742 [debug] [MainThread]: Parsing macros/test_nao_negativo.sql
[0m06:12:50.454963 [debug] [MainThread]: 1699: static parser successfully parsed tables/tb_10_compradores.sql
[0m06:12:50.499159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.analytics_dbt.example

[0m06:12:50.503480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3327415f-a3a8-4565-82e7-fa294ef477aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce11526e50>]}
[0m06:12:50.518010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3327415f-a3a8-4565-82e7-fa294ef477aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce115125b0>]}
[0m06:12:50.518374 [info ] [MainThread]: Found 3 models, 5 tests, 0 snapshots, 0 analyses, 328 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m06:12:50.518695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3327415f-a3a8-4565-82e7-fa294ef477aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce115125e0>]}
[0m06:12:50.520134 [info ] [MainThread]: 
[0m06:12:50.520816 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:12:50.522018 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m06:12:50.532233 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:12:50.532679 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m06:12:50.533051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:12:50.533294 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:52.043323 [debug] [ThreadPool]: SQL status: BEGIN in 1.51 seconds
[0m06:12:52.043898 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m06:12:52.044300 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:12:52.183608 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
[0m06:12:52.185331 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m06:12:52.299494 [debug] [ThreadPool]: On list_dev_public: Close
[0m06:12:52.304186 [debug] [MainThread]: Using redshift connection "master"
[0m06:12:52.304668 [debug] [MainThread]: On master: BEGIN
[0m06:12:52.304904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:12:52.305177 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:53.513356 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
[0m06:12:53.514619 [debug] [MainThread]: Using redshift connection "master"
[0m06:12:53.515542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:12:53.674641 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m06:12:53.677788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3327415f-a3a8-4565-82e7-fa294ef477aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce13dfbcd0>]}
[0m06:12:53.679185 [debug] [MainThread]: On master: ROLLBACK
[0m06:12:53.799272 [debug] [MainThread]: Using redshift connection "master"
[0m06:12:53.800317 [debug] [MainThread]: On master: BEGIN
[0m06:12:54.089994 [debug] [MainThread]: SQL status: BEGIN in 0.29 seconds
[0m06:12:54.090975 [debug] [MainThread]: On master: COMMIT
[0m06:12:54.091531 [debug] [MainThread]: Using redshift connection "master"
[0m06:12:54.092151 [debug] [MainThread]: On master: COMMIT
[0m06:12:54.211790 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m06:12:54.212359 [debug] [MainThread]: On master: Close
[0m06:12:54.213180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:12:54.213536 [info ] [MainThread]: 
[0m06:12:54.217418 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:12:54.217838 [info ] [Thread-1  ]: 1 of 5 START test nao_negativo_tb_10_compradores_comissao ...................... [RUN]
[0m06:12:54.218528 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:12:54.218922 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:12:54.219353 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:12:54.223418 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:12:54.230405 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:54.230724 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:12:54.243698 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:12:54.249652 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:12:54.249869 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: BEGIN
[0m06:12:54.250088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:12:54.250361 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:12:58.363574 [debug] [Thread-1  ]: SQL status: BEGIN in 4.11 seconds
[0m06:12:58.364911 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"
[0m06:12:58.366074 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where comissao < 0


      
    ) dbt_internal_test
[0m06:12:58.751975 [debug] [Thread-1  ]: SQL status: SELECT in 0.38 seconds
[0m06:12:58.756684 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:58.757724 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: ROLLBACK
[0m06:12:58.885654 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54: Close
[0m06:12:58.887826 [info ] [Thread-1  ]: 1 of 5 PASS nao_negativo_tb_10_compradores_comissao ............................ [[32mPASS[0m in 4.67s]
[0m06:12:58.889379 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_comissao.2cce51ff54
[0m06:12:58.890261 [debug] [Thread-1  ]: Began running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:12:58.890827 [info ] [Thread-1  ]: 2 of 5 START test nao_negativo_tb_10_compradores_vendas_totais ................. [RUN]
[0m06:12:58.891999 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:12:58.892474 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:12:58.893052 [debug] [Thread-1  ]: Compiling test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:12:58.898695 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:12:58.908544 [debug] [Thread-1  ]: finished collecting timing info
[0m06:12:58.909163 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:12:58.912687 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:12:58.920785 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:12:58.921039 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: BEGIN
[0m06:12:58.921237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:12:58.921429 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:13:01.358344 [debug] [Thread-1  ]: SQL status: BEGIN in 2.44 seconds
[0m06:13:01.358940 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"
[0m06:13:01.359283 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    *
from "dev"."public"."tb_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m06:13:01.487767 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m06:13:01.491217 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:01.492063 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: ROLLBACK
[0m06:13:01.618483 [debug] [Thread-1  ]: On test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea: Close
[0m06:13:01.620731 [info ] [Thread-1  ]: 2 of 5 PASS nao_negativo_tb_10_compradores_vendas_totais ....................... [[32mPASS[0m in 2.73s]
[0m06:13:01.622234 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.nao_negativo_tb_10_compradores_vendas_totais.9af17926ea
[0m06:13:01.623347 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:13:01.624489 [info ] [Thread-1  ]: 3 of 5 START test not_null_tb_10_compradores_comissao .......................... [RUN]
[0m06:13:01.626153 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:13:01.626849 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:13:01.627628 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:13:01.636926 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:13:01.649034 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:01.649584 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:13:01.651868 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:13:01.660778 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:13:01.661242 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: BEGIN
[0m06:13:01.661496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:13:01.661705 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:13:03.085623 [debug] [Thread-1  ]: SQL status: BEGIN in 1.42 seconds
[0m06:13:03.086606 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"
[0m06:13:03.087304 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."tb_10_compradores"
where comissao is null



      
    ) dbt_internal_test
[0m06:13:03.205947 [debug] [Thread-1  ]: SQL status: SELECT in 0.12 seconds
[0m06:13:03.209824 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:03.210801 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: ROLLBACK
[0m06:13:03.358413 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85: Close
[0m06:13:03.360674 [info ] [Thread-1  ]: 3 of 5 PASS not_null_tb_10_compradores_comissao ................................ [[32mPASS[0m in 1.74s]
[0m06:13:03.362192 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_comissao.b783922f85
[0m06:13:03.363121 [debug] [Thread-1  ]: Began running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:13:03.363900 [info ] [Thread-1  ]: 4 of 5 START test not_null_tb_10_compradores_vendas_totais ..................... [RUN]
[0m06:13:03.365207 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:13:03.365754 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:13:03.366449 [debug] [Thread-1  ]: Compiling test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:13:03.371800 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:13:03.382244 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:03.382712 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:13:03.385229 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:13:03.395266 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:13:03.395698 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: BEGIN
[0m06:13:03.396039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:13:03.396295 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:13:04.586607 [debug] [Thread-1  ]: SQL status: BEGIN in 1.19 seconds
[0m06:13:04.587795 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"
[0m06:13:04.588907 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m06:13:04.791981 [debug] [Thread-1  ]: SQL status: SELECT in 0.2 seconds
[0m06:13:04.795535 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:04.796265 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: ROLLBACK
[0m06:13:04.990485 [debug] [Thread-1  ]: On test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752: Close
[0m06:13:04.992948 [info ] [Thread-1  ]: 4 of 5 PASS not_null_tb_10_compradores_vendas_totais ........................... [[32mPASS[0m in 1.63s]
[0m06:13:04.994707 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.not_null_tb_10_compradores_vendas_totais.ae3fdb0752
[0m06:13:04.995905 [debug] [Thread-1  ]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m06:13:04.996936 [info ] [Thread-1  ]: 5 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m06:13:04.998838 [debug] [Thread-1  ]: Acquiring new redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:13:04.999396 [debug] [Thread-1  ]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m06:13:04.999929 [debug] [Thread-1  ]: Compiling test.analytics_dbt.test_singular_nao_negativo
[0m06:13:05.003575 [debug] [Thread-1  ]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:13:05.011025 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:05.011396 [debug] [Thread-1  ]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m06:13:05.013846 [debug] [Thread-1  ]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m06:13:05.019889 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:13:05.020184 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m06:13:05.020450 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:13:05.020726 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:13:06.530326 [debug] [Thread-1  ]: SQL status: BEGIN in 1.51 seconds
[0m06:13:06.531149 [debug] [Thread-1  ]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m06:13:06.531809 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --test for finding if there is any negative number in the "vendas_totais"

SELECT
    *
from tb_10_compradores
where vendas_totais < 0
      
    ) dbt_internal_test
[0m06:13:06.717944 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m06:13:06.721404 [debug] [Thread-1  ]: finished collecting timing info
[0m06:13:06.722386 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m06:13:06.838269 [debug] [Thread-1  ]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m06:13:06.840422 [info ] [Thread-1  ]: 5 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 1.84s]
[0m06:13:06.841787 [debug] [Thread-1  ]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m06:13:06.845017 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m06:13:06.845619 [debug] [MainThread]: Using redshift connection "master"
[0m06:13:06.846149 [debug] [MainThread]: On master: BEGIN
[0m06:13:06.846601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:13:06.847088 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m06:13:08.057101 [debug] [MainThread]: SQL status: BEGIN in 1.21 seconds
[0m06:13:08.058356 [debug] [MainThread]: On master: COMMIT
[0m06:13:08.059552 [debug] [MainThread]: Using redshift connection "master"
[0m06:13:08.060375 [debug] [MainThread]: On master: COMMIT
[0m06:13:08.280628 [debug] [MainThread]: SQL status: COMMIT in 0.22 seconds
[0m06:13:08.281812 [debug] [MainThread]: On master: Close
[0m06:13:08.283584 [info ] [MainThread]: 
[0m06:13:08.284397 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 17.76 seconds (17.76s).
[0m06:13:08.285166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:13:08.285668 [debug] [MainThread]: Connection 'test.analytics_dbt.test_singular_nao_negativo' was properly closed.
[0m06:13:08.303548 [info ] [MainThread]: 
[0m06:13:08.304051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:13:08.304598 [info ] [MainThread]: 
[0m06:13:08.305445 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:13:08.306140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce114e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce114e08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce114aaac0>]}
[0m06:13:08.306755 [debug] [MainThread]: Flushing usage events
