

============================== 2022-12-02 04:08:48.331704 | 534d0e7b-5965-42f4-bfda-f8441c223cb5 ==============================
[0m04:08:48.331713 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:48.332333 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m04:08:48.332708 [debug] [MainThread]: Tracking: tracking
[0m04:08:48.344652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb638bb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb638bb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb638bb100>]}
[0m04:08:48.452588 [debug] [MainThread]: Executing "git --help"
[0m04:08:48.455916 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:08:48.456457 [debug] [MainThread]: STDERR: "b''"
[0m04:08:48.457240 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m04:08:48.457732 [debug] [MainThread]: Using redshift connection "debug"
[0m04:08:48.458192 [debug] [MainThread]: On debug: select 1 as id
[0m04:08:48.458705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:48.459234 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:08:49.659655 [debug] [MainThread]: SQL status: SELECT in 1.2 seconds
[0m04:08:49.662293 [debug] [MainThread]: On debug: Close
[0m04:08:49.663673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61c1cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61c39310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb61c398e0>]}
[0m04:08:49.664729 [debug] [MainThread]: Flushing usage events
[0m04:08:50.428429 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-03 03:58:18.180826 | 8186f447-8efd-46f6-968f-221a52268a22 ==============================
[0m03:58:18.180838 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:58:18.181673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:58:18.182195 [debug] [MainThread]: Tracking: tracking
[0m03:58:18.193132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1eadd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1eadd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1eadd1c0>]}
[0m03:58:18.356034 [debug] [MainThread]: Executing "git --help"
[0m03:58:18.367423 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:58:18.368035 [debug] [MainThread]: STDERR: "b''"
[0m03:58:18.368854 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m03:58:18.369262 [debug] [MainThread]: Using redshift connection "debug"
[0m03:58:18.369739 [debug] [MainThread]: On debug: select 1 as id
[0m03:58:18.370356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:58:18.371094 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m03:58:20.066024 [debug] [MainThread]: SQL status: SELECT in 1.7 seconds
[0m03:58:20.068856 [debug] [MainThread]: On debug: Close
[0m03:58:20.070390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1ce3daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1ce5e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1ce5e820>]}
[0m03:58:20.071745 [debug] [MainThread]: Flushing usage events
[0m03:58:20.783838 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-12-03 04:04:05.098572 | 5dccf158-cee3-43a9-8d6d-c488ccf4448a ==============================
[0m04:04:05.098586 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:04:05.099131 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:04:05.099647 [debug] [MainThread]: Tracking: tracking
[0m04:04:05.106628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1fac0>]}
[0m04:04:05.128811 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m04:04:05.129764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19cbef70>]}
[0m04:04:05.239761 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:04:05.242088 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:04:05.258973 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:04:05.267886 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:04:05.268848 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:04:05.269600 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:04:05.270178 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:05.272593 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:04:05.273185 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:05.274049 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:05.274671 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:05.275246 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:04:05.276320 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:05.277147 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:04:05.277645 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:04:05.278552 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:04:05.279571 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:04:05.281008 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:04:05.296191 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:04:05.298203 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:04:05.299490 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:04:05.301083 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:04:05.302466 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:05.303678 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:05.304567 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:05.308853 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:04:05.309424 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:05.310028 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:05.311043 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:04:05.315429 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:04:05.321964 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:04:05.331597 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:04:05.335545 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:04:05.337228 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:04:05.346225 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:04:05.349971 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:04:05.351997 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:04:05.353596 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:04:05.358305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:04:05.360096 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:04:05.361304 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:04:05.363093 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:04:05.369048 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:04:05.372664 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:04:05.373333 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:04:05.374023 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:04:05.374784 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:04:05.375893 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:04:05.377562 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:04:05.381256 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:04:05.383031 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:04:05.384390 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:04:05.387459 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:04:05.399270 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:04:05.403913 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:04:05.405217 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:04:05.412741 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:04:05.423654 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:04:05.432121 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:04:05.442693 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:04:05.452160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:04:05.458919 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:04:05.463485 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:04:05.464683 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:04:05.469954 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:04:05.472285 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:04:05.473360 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:04:05.476930 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:04:05.478632 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:04:05.481325 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:04:05.485130 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:05.487132 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:04:05.488051 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:05.489547 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:04:05.490360 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:05.491358 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:04:05.492221 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:04:05.493026 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:04:05.493824 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:05.494778 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:04:05.496227 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:04:05.497303 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:05.498722 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:04:05.499721 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:04:05.500590 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:04:05.501444 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:04:05.502264 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:04:05.503168 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:04:05.504156 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:04:05.505040 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:04:05.509428 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:04:05.510202 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:04:05.511432 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:04:05.512365 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:04:05.513495 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:04:05.697307 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:04:05.706311 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:04:05.770688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18149ac0>]}
[0m04:04:05.789783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d08910>]}
[0m04:04:05.790239 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:04:05.790678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e1814cf70>]}
[0m04:04:05.792001 [info ] [MainThread]: 
[0m04:04:05.792940 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:04:05.794288 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:04:05.805716 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:04:05.806339 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:04:05.806828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:04:05.807229 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:07.379643 [debug] [ThreadPool]: SQL status: SELECT in 1.57 seconds
[0m04:04:07.381775 [debug] [ThreadPool]: On list_dev: Close
[0m04:04:07.384348 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:04:07.423620 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:04:07.423961 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:04:07.424321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:07.424666 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:08.751985 [debug] [ThreadPool]: SQL status: BEGIN in 1.33 seconds
[0m04:04:08.752797 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:04:08.753342 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:04:08.894637 [debug] [ThreadPool]: SQL status: SELECT in 0.14 seconds
[0m04:04:08.896351 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:04:09.005566 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:04:09.011824 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:09.012555 [debug] [MainThread]: On master: BEGIN
[0m04:04:09.013143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:04:09.013624 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:10.276355 [debug] [MainThread]: SQL status: BEGIN in 1.26 seconds
[0m04:04:10.277439 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:10.278337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:04:10.439423 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m04:04:10.442392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18132be0>]}
[0m04:04:10.443569 [debug] [MainThread]: On master: ROLLBACK
[0m04:04:10.583065 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:10.584047 [debug] [MainThread]: On master: BEGIN
[0m04:04:11.088668 [debug] [MainThread]: SQL status: BEGIN in 0.5 seconds
[0m04:04:11.089954 [debug] [MainThread]: On master: COMMIT
[0m04:04:11.091112 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:11.092202 [debug] [MainThread]: On master: COMMIT
[0m04:04:11.252814 [debug] [MainThread]: SQL status: COMMIT in 0.16 seconds
[0m04:04:11.253394 [debug] [MainThread]: On master: Close
[0m04:04:11.254382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:04:11.254863 [info ] [MainThread]: 
[0m04:04:11.266599 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:04:11.267445 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:04:11.268334 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.268806 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:04:11.269196 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:04:11.272216 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.291718 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:11.292079 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:04:11.333338 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.341823 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:11.342041 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:04:11.342235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:04:11.342446 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:12.838143 [debug] [Thread-1  ]: SQL status: BEGIN in 1.5 seconds
[0m04:04:12.839408 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:12.840564 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:04:13.444219 [debug] [Thread-1  ]: SQL status: SELECT in 0.6 seconds
[0m04:04:13.450892 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.451699 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:04:13.576611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:04:13.592328 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:13.593067 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.593833 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:13.781770 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m04:04:13.782602 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.782989 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:04:13.905186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:04:13.912581 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:13.913642 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:04:14.033423 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m04:04:14.034788 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:14.035235 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:14.035791 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:04:14.160962 [debug] [Thread-1  ]: SQL status: COMMIT in 0.12 seconds
[0m04:04:14.161874 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:04:14.162492 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:04:14.359369 [debug] [Thread-1  ]: SQL status: BEGIN in 0.2 seconds
[0m04:04:14.361120 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:14.362116 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:04:14.482500 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:04:14.484829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18175d30>]}
[0m04:04:14.486304 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 3.22s]
[0m04:04:14.487648 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:04:14.489770 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:04:14.491375 [info ] [Thread-1  ]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:04:14.494812 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.495481 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:04:14.496108 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:04:14.499859 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.509303 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:14.509652 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:04:14.530518 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.540824 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:14.541110 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:04:14.541467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:04:14.541796 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:15.524118 [debug] [Thread-1  ]: SQL status: BEGIN in 0.98 seconds
[0m04:04:15.524981 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:15.525711 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:04:15.703128 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.18 seconds
[0m04:04:15.706010 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:15.706567 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:04:15.815256 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:04:15.818128 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:15.818822 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:15.819416 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:16.018065 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:04:16.019616 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.020714 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:04:16.214442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m04:04:16.216750 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.217277 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:04:16.422370 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:04:16.424626 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:16.425450 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.426297 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:04:16.625949 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:04:16.627060 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:04:16.628079 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:04:16.743770 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:04:16.745056 [debug] [Thread-1  ]: finished collecting timing info
[0m04:04:16.745888 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:04:16.886133 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:04:16.887414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dccf158-cee3-43a9-8d6d-c488ccf4448a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e18175d30>]}
[0m04:04:16.888081 [info ] [Thread-1  ]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.39s]
[0m04:04:16.888920 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:04:16.890574 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:04:16.891104 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:16.891567 [debug] [MainThread]: On master: BEGIN
[0m04:04:16.891994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:04:16.892296 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:04:18.113275 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
[0m04:04:18.114501 [debug] [MainThread]: On master: COMMIT
[0m04:04:18.115639 [debug] [MainThread]: Using redshift connection "master"
[0m04:04:18.116576 [debug] [MainThread]: On master: COMMIT
[0m04:04:18.266067 [debug] [MainThread]: SQL status: COMMIT in 0.15 seconds
[0m04:04:18.267354 [debug] [MainThread]: On master: Close
[0m04:04:18.269327 [info ] [MainThread]: 
[0m04:04:18.270512 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.48 seconds (12.48s).
[0m04:04:18.271541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:04:18.272213 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:04:18.289873 [info ] [MainThread]: 
[0m04:04:18.290304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:04:18.290838 [info ] [MainThread]: 
[0m04:04:18.291360 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:04:18.292124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19d1fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19bb30a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e19bfcbb0>]}
[0m04:04:18.292831 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:24:38.832067 | 8c31e550-dd34-4acb-93a7-008d380ff25f ==============================
[0m04:24:38.832078 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:24:38.832510 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['views/vw_sales.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:24:38.832722 [debug] [MainThread]: Tracking: tracking
[0m04:24:38.839957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c4a00>]}
[0m04:24:38.869927 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:24:38.870366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3a4040>]}
[0m04:24:38.936541 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:24:38.938390 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:24:38.954818 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:24:38.963033 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:24:38.963645 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:24:38.964252 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:24:38.964887 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:24:38.967180 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:24:38.967818 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:24:38.968701 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:24:38.969334 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:24:38.969972 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:24:38.970524 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:24:38.971310 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:24:38.971828 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:24:38.972396 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:24:38.972963 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:24:38.974314 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:24:38.988859 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:24:38.990514 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:24:38.991548 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:24:38.992767 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:24:38.993622 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:24:38.994724 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:24:38.995594 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:24:38.999774 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:24:39.000308 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:24:39.000892 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:24:39.001907 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:24:39.006115 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:24:39.012211 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:24:39.021004 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:24:39.024413 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:24:39.026989 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:24:39.037431 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:24:39.040911 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:24:39.044021 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:24:39.046389 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:24:39.053261 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:24:39.056292 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:24:39.058247 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:24:39.060296 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:24:39.066518 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:24:39.070388 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:24:39.071311 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:24:39.072298 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:24:39.073350 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:24:39.074741 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:24:39.076613 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:24:39.079644 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:24:39.081224 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:24:39.083109 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:24:39.086706 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:24:39.098091 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:24:39.104426 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:24:39.106510 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:24:39.114957 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:24:39.126943 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:24:39.136319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:24:39.148687 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:24:39.158813 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:24:39.165775 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:24:39.172614 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:24:39.174627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:24:39.181726 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:24:39.184762 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:24:39.186470 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:24:39.192218 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:24:39.194761 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:24:39.198104 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:24:39.202221 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:24:39.204984 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:24:39.206493 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:24:39.209148 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:24:39.210672 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:24:39.212442 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:24:39.213958 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:24:39.215461 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:24:39.216940 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:24:39.218825 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:24:39.220425 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:24:39.222276 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:24:39.224071 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:24:39.225537 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:24:39.227025 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:24:39.228721 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:24:39.230272 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:24:39.232031 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:24:39.233668 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:24:39.235318 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:24:39.241405 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:24:39.242751 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:24:39.244787 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:24:39.246235 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:24:39.247843 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:24:39.426157 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m04:24:39.436373 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m04:24:39.439718 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:24:39.522888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c33cc40>]}
[0m04:24:39.538953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c355460>]}
[0m04:24:39.539335 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:24:39.539804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c31e550-dd34-4acb-93a7-008d380ff25f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa349982f10>]}
[0m04:24:39.541275 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m04:24:39.542211 [info ] [MainThread]: 
[0m04:24:39.542554 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:24:39.555441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c35fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c3c4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa34c32c160>]}
[0m04:24:39.555929 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:25:36.078293 | a37110cd-2b77-4836-bf24-2d4e37355891 ==============================
[0m04:25:36.078305 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:25:36.078876 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:25:36.079349 [debug] [MainThread]: Tracking: tracking
[0m04:25:36.086405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d50109d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5010a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5010ac0>]}
[0m04:25:36.257866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:25:36.258335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:25:36.263233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4f0db20>]}
[0m04:25:36.277175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4fac400>]}
[0m04:25:36.277633 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:25:36.278279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4fac700>]}
[0m04:25:36.279604 [info ] [MainThread]: 
[0m04:25:36.280460 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:25:36.282237 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:25:36.294005 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:25:36.294624 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:25:36.295305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:36.295938 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:37.690470 [debug] [ThreadPool]: SQL status: SELECT in 1.4 seconds
[0m04:25:37.692064 [debug] [ThreadPool]: On list_dev: Close
[0m04:25:37.694158 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:25:37.699709 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:25:37.700163 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:25:37.700478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:37.700712 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:38.899615 [debug] [ThreadPool]: SQL status: BEGIN in 1.2 seconds
[0m04:25:38.900804 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:25:38.901767 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:25:39.032234 [debug] [ThreadPool]: SQL status: SELECT in 0.13 seconds
[0m04:25:39.034142 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:25:39.150021 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:25:39.154544 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:39.154989 [debug] [MainThread]: On master: BEGIN
[0m04:25:39.155494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:25:39.155989 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:40.267220 [debug] [MainThread]: SQL status: BEGIN in 1.11 seconds
[0m04:25:40.267903 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:40.268437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:25:40.430298 [debug] [MainThread]: SQL status: SELECT in 0.16 seconds
[0m04:25:40.432056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4ed63d0>]}
[0m04:25:40.432836 [debug] [MainThread]: On master: ROLLBACK
[0m04:25:40.550623 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:40.551304 [debug] [MainThread]: On master: BEGIN
[0m04:25:40.836175 [debug] [MainThread]: SQL status: BEGIN in 0.28 seconds
[0m04:25:40.837449 [debug] [MainThread]: On master: COMMIT
[0m04:25:40.838510 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:40.839460 [debug] [MainThread]: On master: COMMIT
[0m04:25:41.050006 [debug] [MainThread]: SQL status: COMMIT in 0.21 seconds
[0m04:25:41.050671 [debug] [MainThread]: On master: Close
[0m04:25:41.051635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:25:41.052185 [info ] [MainThread]: 
[0m04:25:41.055361 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:25:41.056138 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:25:41.057187 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.057561 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:25:41.058032 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:25:41.061480 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.071285 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:41.071683 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:25:41.108108 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.121797 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:41.122215 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:25:41.122521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:41.122828 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:42.533824 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m04:25:42.534447 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:42.534942 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:25:42.706425 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m04:25:42.717520 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:42.718193 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:25:42.847419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:25:42.853990 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:42.854828 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:25:42.996675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m04:25:43.025985 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.026716 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.027279 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.220274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.19 seconds
[0m04:25:43.221843 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.222773 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:25:43.409365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.19 seconds
[0m04:25:43.418010 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.418623 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:25:43.551742 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m04:25:43.554317 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.555347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.556180 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:25:43.714781 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:25:43.715944 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:25:43.717017 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:25:43.845513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:25:43.846950 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:43.847676 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:25:43.975770 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:25:43.978121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d45cb910>]}
[0m04:25:43.979466 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.92s]
[0m04:25:43.980912 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:25:43.982001 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:25:43.983471 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:25:43.985294 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:25:43.985966 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:25:43.986614 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:25:43.989132 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:25:44.004259 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:44.004667 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:25:44.024337 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:25:44.040917 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:25:44.041356 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:25:44.041663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:44.041946 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:45.325441 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m04:25:45.326670 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:25:45.327800 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PREICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA

    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:25:45.458155 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "preicepaid" does not exist in source_sales

[0m04:25:45.458992 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:25:45.586731 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:45.588017 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:25:45.590135 [debug] [Thread-1  ]: Database Error in model vw_sales (models/views/vw_sales.sql)
  column "preicepaid" does not exist in source_sales
  compiled Code at target/run/analytics_dbt/models/views/vw_sales.sql
[0m04:25:45.591335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4600670>]}
[0m04:25:45.592699 [error] [Thread-1  ]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.61s]
[0m04:25:45.594179 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:25:45.595358 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:25:45.596279 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:25:45.597632 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.598175 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:25:45.598721 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:25:45.602624 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.614477 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:45.614971 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:25:45.618257 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.624749 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:45.625027 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:25:45.625255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:25:45.625608 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:47.037532 [debug] [Thread-1  ]: SQL status: BEGIN in 1.41 seconds
[0m04:25:47.038939 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.040081 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:25:47.164845 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:25:47.170478 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.171187 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:25:47.294620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:25:47.299490 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:47.300490 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.301186 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:47.447165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:25:47.448017 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.448351 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:25:47.607056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m04:25:47.611932 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.612875 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:25:47.812435 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:25:47.815031 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:47.816126 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:47.817211 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:25:48.014654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:25:48.015878 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:25:48.016966 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:25:48.139313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:25:48.141138 [debug] [Thread-1  ]: finished collecting timing info
[0m04:25:48.142263 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:25:48.324597 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:25:48.326939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37110cd-2b77-4836-bf24-2d4e37355891', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4568c40>]}
[0m04:25:48.328399 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.73s]
[0m04:25:48.329896 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:25:48.333771 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:25:48.334671 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:48.335560 [debug] [MainThread]: On master: BEGIN
[0m04:25:48.336316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:25:48.337026 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:25:49.559665 [debug] [MainThread]: SQL status: BEGIN in 1.22 seconds
[0m04:25:49.560869 [debug] [MainThread]: On master: COMMIT
[0m04:25:49.561618 [debug] [MainThread]: Using redshift connection "master"
[0m04:25:49.562292 [debug] [MainThread]: On master: COMMIT
[0m04:25:49.756850 [debug] [MainThread]: SQL status: COMMIT in 0.19 seconds
[0m04:25:49.757966 [debug] [MainThread]: On master: Close
[0m04:25:49.760012 [info ] [MainThread]: 
[0m04:25:49.761114 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.48 seconds (13.48s).
[0m04:25:49.762153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:49.762970 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:25:49.786717 [info ] [MainThread]: 
[0m04:25:49.787103 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:25:49.787616 [info ] [MainThread]: 
[0m04:25:49.788031 [error] [MainThread]: [33mDatabase Error in model vw_sales (models/views/vw_sales.sql)[0m
[0m04:25:49.788724 [error] [MainThread]:   column "preicepaid" does not exist in source_sales
[0m04:25:49.789173 [error] [MainThread]:   compiled Code at target/run/analytics_dbt/models/views/vw_sales.sql
[0m04:25:49.789596 [info ] [MainThread]: 
[0m04:25:49.790030 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m04:25:49.790571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d460c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d45162b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d4516670>]}
[0m04:25:49.791272 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:26:08.249693 | 3aec6885-fb2f-48ac-8953-de7959f83641 ==============================
[0m04:26:08.249705 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:26:08.250156 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:26:08.250739 [debug] [MainThread]: Tracking: tracking
[0m04:26:08.257522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc822baac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc822bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc822babb0>]}
[0m04:26:08.370653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:26:08.371140 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:26:08.382252 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:26:08.408413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc821783a0>]}
[0m04:26:08.425211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc82197f10>]}
[0m04:26:08.425582 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:26:08.426110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8213e640>]}
[0m04:26:08.427577 [info ] [MainThread]: 
[0m04:26:08.428686 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:26:08.430064 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:26:08.440224 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:26:08.440696 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:26:08.441056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:08.441283 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:09.564258 [debug] [ThreadPool]: SQL status: SELECT in 1.12 seconds
[0m04:26:09.567893 [debug] [ThreadPool]: On list_dev: Close
[0m04:26:09.572445 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:26:09.582839 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:26:09.583356 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:26:09.583852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:26:09.584381 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:11.172793 [debug] [ThreadPool]: SQL status: BEGIN in 1.59 seconds
[0m04:26:11.173469 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:26:11.173969 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:26:11.385460 [debug] [ThreadPool]: SQL status: SELECT in 0.21 seconds
[0m04:26:11.388221 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:26:11.568516 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:26:11.574049 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:11.574386 [debug] [MainThread]: On master: BEGIN
[0m04:26:11.574633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:26:11.574978 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:12.914488 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
[0m04:26:12.915889 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:12.917181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:26:13.087940 [debug] [MainThread]: SQL status: SELECT in 0.17 seconds
[0m04:26:13.091782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc82178550>]}
[0m04:26:13.093031 [debug] [MainThread]: On master: ROLLBACK
[0m04:26:13.224763 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:13.225961 [debug] [MainThread]: On master: BEGIN
[0m04:26:13.541304 [debug] [MainThread]: SQL status: BEGIN in 0.31 seconds
[0m04:26:13.542390 [debug] [MainThread]: On master: COMMIT
[0m04:26:13.543153 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:13.543983 [debug] [MainThread]: On master: COMMIT
[0m04:26:13.675163 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m04:26:13.676525 [debug] [MainThread]: On master: Close
[0m04:26:13.678580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:26:13.679842 [info ] [MainThread]: 
[0m04:26:13.684689 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:26:13.685270 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:26:13.686215 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.686668 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:26:13.687164 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:26:13.689986 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.701320 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:13.701769 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:26:13.736411 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.742640 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:13.742832 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:26:13.743018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:13.743201 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:14.846563 [debug] [Thread-1  ]: SQL status: BEGIN in 1.1 seconds
[0m04:26:14.847630 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:14.848512 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:26:15.002671 [debug] [Thread-1  ]: SQL status: SELECT in 0.15 seconds
[0m04:26:15.008198 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.008846 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:26:15.148029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m04:26:15.151075 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.151623 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:26:15.263611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:26:15.281757 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.282452 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.283157 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.432692 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:26:15.433568 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.434145 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:26:15.544493 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:26:15.548879 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.549484 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:26:15.663999 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.11 seconds
[0m04:26:15.665717 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.666264 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.666698 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:26:15.875178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.21 seconds
[0m04:26:15.876473 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:26:15.877541 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:26:15.989182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:26:15.990277 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:15.991033 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:26:16.177587 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:26:16.179126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc8007a850>]}
[0m04:26:16.180018 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.49s]
[0m04:26:16.181078 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:26:16.181786 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:26:16.182516 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:26:16.183461 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:16.183884 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:26:16.184410 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:26:16.186784 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:26:16.197738 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:16.198163 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:26:16.218415 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:26:16.224811 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:16.225055 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:26:16.225378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:16.225789 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:17.515472 [debug] [Thread-1  ]: SQL status: BEGIN in 1.29 seconds
[0m04:26:17.516163 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.516615 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA

    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:26:17.646273 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m04:26:17.652066 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.652872 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:26:17.778655 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:26:17.782910 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:17.784104 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.785072 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:17.942328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:26:17.943931 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:17.944923 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:26:18.092875 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:26:18.097679 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:18.098774 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:26:18.224574 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m04:26:18.227103 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:18.228168 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:18.229132 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:26:18.379253 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:26:18.380028 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:26:18.380599 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:26:18.505264 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:26:18.507187 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:18.508235 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:26:18.668866 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:26:18.671346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc517bff70>]}
[0m04:26:18.673037 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.49s]
[0m04:26:18.674499 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:26:18.675622 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:26:18.676741 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:26:18.678284 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.678854 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:26:18.679447 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:26:18.685272 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.695241 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:18.695817 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:26:18.700881 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.708340 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:18.708646 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:26:18.708895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:26:18.709178 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:20.065976 [debug] [Thread-1  ]: SQL status: BEGIN in 1.36 seconds
[0m04:26:20.067110 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.067951 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:26:20.272550 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m04:26:20.277065 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.277820 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:26:20.476159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.2 seconds
[0m04:26:20.477949 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:20.478470 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.478899 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:20.726141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.25 seconds
[0m04:26:20.727590 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.728470 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:26:20.889049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.16 seconds
[0m04:26:20.892194 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:20.892769 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:26:21.089718 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:26:21.090914 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:21.091369 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:21.091791 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:26:21.246935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:26:21.247772 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:26:21.248410 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:26:21.374948 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:26:21.376392 [debug] [Thread-1  ]: finished collecting timing info
[0m04:26:21.377221 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:26:21.506143 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:26:21.508654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aec6885-fb2f-48ac-8953-de7959f83641', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc800ebf40>]}
[0m04:26:21.509963 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.83s]
[0m04:26:21.511350 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:26:21.514385 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:26:21.514928 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:21.515399 [debug] [MainThread]: On master: BEGIN
[0m04:26:21.515848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:26:21.516328 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:26:22.864153 [debug] [MainThread]: SQL status: BEGIN in 1.35 seconds
[0m04:26:22.865408 [debug] [MainThread]: On master: COMMIT
[0m04:26:22.866604 [debug] [MainThread]: Using redshift connection "master"
[0m04:26:22.867553 [debug] [MainThread]: On master: COMMIT
[0m04:26:23.036600 [debug] [MainThread]: SQL status: COMMIT in 0.17 seconds
[0m04:26:23.037973 [debug] [MainThread]: On master: Close
[0m04:26:23.040104 [info ] [MainThread]: 
[0m04:26:23.041418 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.61 seconds (14.61s).
[0m04:26:23.042532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:26:23.043290 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:26:23.070423 [info ] [MainThread]: 
[0m04:26:23.071111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:26:23.071674 [info ] [MainThread]: 
[0m04:26:23.072164 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:26:23.072892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc868f1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc51783ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc517837c0>]}
[0m04:26:23.073362 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:30:35.727310 | 27bf8dda-e5c7-4c0d-ad49-0b8826d72309 ==============================
[0m04:30:35.727324 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:30:35.727914 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:30:35.728336 [debug] [MainThread]: Tracking: tracking
[0m04:30:35.735293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d6c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d6c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d6ca00>]}
[0m04:30:35.875897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:30:35.876351 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:30:35.888713 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:30:35.915374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550c721f0>]}
[0m04:30:35.927426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550c49d60>]}
[0m04:30:35.927907 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:30:35.928533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550bf24c0>]}
[0m04:30:35.930149 [info ] [MainThread]: 
[0m04:30:35.931133 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:30:35.932285 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:30:35.941319 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:30:35.941645 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:30:35.941887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:30:35.942095 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:37.122737 [debug] [ThreadPool]: SQL status: SELECT in 1.18 seconds
[0m04:30:37.126335 [debug] [ThreadPool]: On list_dev: Close
[0m04:30:37.130923 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:30:37.141588 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:30:37.142089 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:30:37.142594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:30:37.143172 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:38.280511 [debug] [ThreadPool]: SQL status: BEGIN in 1.14 seconds
[0m04:30:38.281258 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:30:38.281858 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:30:38.406218 [debug] [ThreadPool]: SQL status: SELECT in 0.12 seconds
[0m04:30:38.409765 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:30:38.525994 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:30:38.531015 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:38.531723 [debug] [MainThread]: On master: BEGIN
[0m04:30:38.532231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:30:38.532575 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:39.678279 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m04:30:39.679269 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:39.680098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:30:39.827505 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m04:30:39.830661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff550d16430>]}
[0m04:30:39.831934 [debug] [MainThread]: On master: ROLLBACK
[0m04:30:39.962074 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:39.963281 [debug] [MainThread]: On master: BEGIN
[0m04:30:40.223967 [debug] [MainThread]: SQL status: BEGIN in 0.26 seconds
[0m04:30:40.225019 [debug] [MainThread]: On master: COMMIT
[0m04:30:40.225849 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:40.226625 [debug] [MainThread]: On master: COMMIT
[0m04:30:40.335551 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m04:30:40.336829 [debug] [MainThread]: On master: Close
[0m04:30:40.338911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:30:40.340153 [info ] [MainThread]: 
[0m04:30:40.346890 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:30:40.347695 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:30:40.348782 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.349161 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:30:40.349720 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:30:40.353819 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.367994 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:40.368471 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:30:40.403638 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.412030 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:40.412474 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:30:40.412710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:30:40.412935 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:41.853779 [debug] [Thread-1  ]: SQL status: BEGIN in 1.44 seconds
[0m04:30:41.855084 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:41.856099 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:30:42.025991 [debug] [Thread-1  ]: SQL status: SELECT in 0.17 seconds
[0m04:30:42.036677 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.037444 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:30:42.178005 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.14 seconds
[0m04:30:42.183884 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.184629 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:30:42.341250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.16 seconds
[0m04:30:42.367872 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.368827 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.369356 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.531767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:30:42.532511 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.532767 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:30:42.647493 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:30:42.657515 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.658230 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:30:42.774506 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.12 seconds
[0m04:30:42.775899 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.776653 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.777211 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:30:42.931895 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:30:42.932966 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:30:42.933570 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:30:43.080693 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:30:43.082750 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:43.083873 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:30:43.198552 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:30:43.199941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff55013ed00>]}
[0m04:30:43.200772 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.85s]
[0m04:30:43.201796 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:30:43.202227 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:30:43.202731 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:30:43.203876 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:43.204381 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:30:43.204912 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:30:43.207069 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:30:43.217885 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:43.218309 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:30:43.234293 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:30:43.240652 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:43.240848 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:30:43.241185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:30:43.241705 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:44.237897 [debug] [Thread-1  ]: SQL status: BEGIN in 1.0 seconds
[0m04:30:44.239125 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.240047 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA

    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:30:44.356049 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:30:44.362923 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.363827 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:30:44.569607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.21 seconds
[0m04:30:44.574347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.575291 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:30:44.776376 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.2 seconds
[0m04:30:44.779391 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:44.780234 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.781062 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:44.926219 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:30:44.927330 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:44.928110 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:30:45.038170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:30:45.040169 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:45.040622 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:30:45.151680 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.11 seconds
[0m04:30:45.152925 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:45.153345 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:45.153807 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:30:45.395527 [debug] [Thread-1  ]: SQL status: COMMIT in 0.24 seconds
[0m04:30:45.396581 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:30:45.397429 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:30:45.547819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:30:45.549687 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:45.550787 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:30:45.671575 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:30:45.673990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5500a21c0>]}
[0m04:30:45.675491 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.47s]
[0m04:30:45.677099 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:30:45.678071 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:30:45.679105 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:30:45.681082 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.681646 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:30:45.682323 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:30:45.686480 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.697233 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:45.697951 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:30:45.701498 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.708944 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:45.709166 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:30:45.709399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:30:45.709616 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:46.994266 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m04:30:46.995493 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:46.996380 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:30:47.124738 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m04:30:47.130744 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.131536 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:30:47.263363 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:30:47.265926 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.266569 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.267204 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.418132 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:30:47.419029 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.419624 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:30:47.544000 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:30:47.546088 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.546605 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:30:47.725401 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:30:47.728119 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.729115 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.730071 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:30:47.882135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:30:47.883264 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:30:47.884583 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:30:48.051800 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m04:30:48.053612 [debug] [Thread-1  ]: finished collecting timing info
[0m04:30:48.054596 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:30:48.258716 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:30:48.260569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27bf8dda-e5c7-4c0d-ad49-0b8826d72309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501a27f0>]}
[0m04:30:48.261962 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.58s]
[0m04:30:48.262937 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:30:48.265041 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:30:48.265553 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:48.265995 [debug] [MainThread]: On master: BEGIN
[0m04:30:48.266420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:30:48.266873 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:30:49.412195 [debug] [MainThread]: SQL status: BEGIN in 1.15 seconds
[0m04:30:49.413118 [debug] [MainThread]: On master: COMMIT
[0m04:30:49.413705 [debug] [MainThread]: Using redshift connection "master"
[0m04:30:49.414209 [debug] [MainThread]: On master: COMMIT
[0m04:30:49.530103 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:30:49.531080 [debug] [MainThread]: On master: Close
[0m04:30:49.532458 [info ] [MainThread]: 
[0m04:30:49.533251 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m04:30:49.533958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:30:49.534619 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:30:49.557196 [info ] [MainThread]: 
[0m04:30:49.557694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:30:49.558370 [info ] [MainThread]: 
[0m04:30:49.558914 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:30:49.559706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501b0c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501b0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5501ac850>]}
[0m04:30:49.560405 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:31:23.816354 | f30b64c3-5486-4c7e-ac6c-50b95a02bce8 ==============================
[0m04:31:23.816366 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:31:23.817105 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:31:23.817661 [debug] [MainThread]: Tracking: tracking
[0m04:31:23.824403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307cb10a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307cb10ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307cb10af0>]}
[0m04:31:23.939011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:31:23.939499 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:31:23.950910 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:31:23.975964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c94e2e0>]}
[0m04:31:23.987222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c96ee50>]}
[0m04:31:23.987512 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:31:23.987785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c9d65b0>]}
[0m04:31:23.989064 [info ] [MainThread]: 
[0m04:31:23.989738 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:31:23.991132 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:31:24.002068 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:31:24.002508 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:31:24.002719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:31:24.002916 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:25.039623 [debug] [ThreadPool]: SQL status: SELECT in 1.04 seconds
[0m04:31:25.043224 [debug] [ThreadPool]: On list_dev: Close
[0m04:31:25.046828 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:31:25.056527 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:31:25.057165 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:31:25.057749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:31:25.058333 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:26.452162 [debug] [ThreadPool]: SQL status: BEGIN in 1.39 seconds
[0m04:31:26.453250 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:31:26.454053 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:31:26.605428 [debug] [ThreadPool]: SQL status: SELECT in 0.15 seconds
[0m04:31:26.608745 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:31:26.728416 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:31:26.738389 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:26.739018 [debug] [MainThread]: On master: BEGIN
[0m04:31:26.739596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:31:26.740289 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:27.814336 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m04:31:27.815669 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:27.816810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:31:27.966653 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m04:31:27.970083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c94e730>]}
[0m04:31:27.971412 [debug] [MainThread]: On master: ROLLBACK
[0m04:31:28.081657 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:28.082805 [debug] [MainThread]: On master: BEGIN
[0m04:31:28.303067 [debug] [MainThread]: SQL status: BEGIN in 0.22 seconds
[0m04:31:28.303763 [debug] [MainThread]: On master: COMMIT
[0m04:31:28.304259 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:28.304748 [debug] [MainThread]: On master: COMMIT
[0m04:31:28.502175 [debug] [MainThread]: SQL status: COMMIT in 0.2 seconds
[0m04:31:28.503263 [debug] [MainThread]: On master: Close
[0m04:31:28.504982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:31:28.505950 [info ] [MainThread]: 
[0m04:31:28.512085 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:31:28.512767 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:31:28.513737 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.514112 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:31:28.514605 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:31:28.518106 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.527797 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:28.528223 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:31:28.564708 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.574165 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:28.574468 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:31:28.574670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:31:28.574910 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:29.705675 [debug] [Thread-1  ]: SQL status: BEGIN in 1.13 seconds
[0m04:31:29.706540 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:29.707381 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:31:29.869964 [debug] [Thread-1  ]: SQL status: SELECT in 0.16 seconds
[0m04:31:29.879534 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:29.880154 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:31:30.030313 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.15 seconds
[0m04:31:30.036168 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.036828 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:31:30.148043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:31:30.174900 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.175716 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.176614 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.331426 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:31:30.332547 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.333052 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:31:30.443286 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:31:30.447898 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.448496 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:31:30.560620 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.11 seconds
[0m04:31:30.563321 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.564360 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.565331 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:31:30.707190 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:31:30.707978 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:31:30.708632 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:31:30.855819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:31:30.857644 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:30.858594 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:31:31.060807 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:31:31.063176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c09d8e0>]}
[0m04:31:31.064737 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.55s]
[0m04:31:31.066509 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:31:31.067769 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:31:31.068962 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:31:31.070677 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:31.071209 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:31:31.071774 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:31:31.074044 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:31:31.084694 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:31.085186 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:31:31.105877 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:31:31.115649 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:31.116307 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:31:31.117090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:31:31.117705 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:32.393863 [debug] [Thread-1  ]: SQL status: BEGIN in 1.28 seconds
[0m04:31:32.394886 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.395525 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA,
        cast(saletime as date) as DATA_VENDA
    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:31:32.597875 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m04:31:32.604531 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.605337 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:31:32.802440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.2 seconds
[0m04:31:32.808034 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.808914 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:31:32.938204 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:31:32.943008 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:32.944121 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:32.944888 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:33.098159 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:31:33.099118 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.099714 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:31:33.229004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:31:33.231201 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.231870 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:31:33.407868 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:31:33.409607 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:33.410138 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.410701 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:31:33.578374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.17 seconds
[0m04:31:33.579450 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:31:33.580239 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:31:33.732880 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
[0m04:31:33.733951 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:33.734414 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:31:33.861390 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:31:33.864147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c005af0>]}
[0m04:31:33.865794 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.79s]
[0m04:31:33.867528 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:31:33.868777 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:31:33.869966 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:31:33.872261 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.873060 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:31:33.874049 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:31:33.878787 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.888798 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:33.889230 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:31:33.892466 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.902401 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:33.902749 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:31:33.902963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:31:33.903308 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:35.395586 [debug] [Thread-1  ]: SQL status: BEGIN in 1.49 seconds
[0m04:31:35.396706 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.397642 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:31:35.523754 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.13 seconds
[0m04:31:35.526656 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.527204 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:31:35.647006 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:31:35.650787 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:35.651701 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.652489 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:35.797855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:31:35.799347 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.800443 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:31:35.975894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m04:31:35.980973 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:35.981902 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:31:36.161710 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.18 seconds
[0m04:31:36.162966 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:36.163542 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:36.164190 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:31:36.386610 [debug] [Thread-1  ]: SQL status: COMMIT in 0.22 seconds
[0m04:31:36.387237 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:31:36.387903 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:31:36.506124 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:31:36.507828 [debug] [Thread-1  ]: finished collecting timing info
[0m04:31:36.508858 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:31:36.627484 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:31:36.629123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f30b64c3-5486-4c7e-ac6c-50b95a02bce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c1029d0>]}
[0m04:31:36.629949 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.76s]
[0m04:31:36.630881 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:31:36.633948 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:31:36.634825 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:36.635192 [debug] [MainThread]: On master: BEGIN
[0m04:31:36.635554 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:31:36.635908 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:31:37.975589 [debug] [MainThread]: SQL status: BEGIN in 1.34 seconds
[0m04:31:37.976871 [debug] [MainThread]: On master: COMMIT
[0m04:31:37.977746 [debug] [MainThread]: Using redshift connection "master"
[0m04:31:37.978650 [debug] [MainThread]: On master: COMMIT
[0m04:31:38.105668 [debug] [MainThread]: SQL status: COMMIT in 0.13 seconds
[0m04:31:38.106927 [debug] [MainThread]: On master: Close
[0m04:31:38.108862 [info ] [MainThread]: 
[0m04:31:38.110014 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.12 seconds (14.12s).
[0m04:31:38.111199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:31:38.112022 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:31:38.138302 [info ] [MainThread]: 
[0m04:31:38.138864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:31:38.139430 [info ] [MainThread]: 
[0m04:31:38.140108 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:31:38.140828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c11bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c11b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307c10ff40>]}
[0m04:31:38.141453 [debug] [MainThread]: Flushing usage events


============================== 2022-12-03 04:33:17.850299 | 8be5e778-efbd-4119-998d-aeac863f3f2d ==============================
[0m04:33:17.850314 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:33:17.850799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:33:17.851172 [debug] [MainThread]: Tracking: tracking
[0m04:33:17.857949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff650a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff650ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff650af0>]}
[0m04:33:17.989351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:33:17.989858 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models/views/vw_sales.sql
[0m04:33:18.001520 [debug] [MainThread]: 1699: static parser successfully parsed views/vw_sales.sql
[0m04:33:18.028155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff5122e0>]}
[0m04:33:18.040321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff532e50>]}
[0m04:33:18.040650 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:33:18.040931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff4da5b0>]}
[0m04:33:18.042623 [info ] [MainThread]: 
[0m04:33:18.043333 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:33:18.044764 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev"
[0m04:33:18.055116 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m04:33:18.055878 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
  
[0m04:33:18.056406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:33:18.056787 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:19.297515 [debug] [ThreadPool]: SQL status: SELECT in 1.24 seconds
[0m04:33:19.300961 [debug] [ThreadPool]: On list_dev: Close
[0m04:33:19.304353 [debug] [ThreadPool]: Acquiring new redshift connection "list_dev_public"
[0m04:33:19.313331 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:33:19.314050 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m04:33:19.314724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:33:19.315339 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:20.690744 [debug] [ThreadPool]: SQL status: BEGIN in 1.38 seconds
[0m04:33:20.692165 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m04:33:20.693375 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
      'dev' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dev' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:33:20.819236 [debug] [ThreadPool]: SQL status: SELECT in 0.12 seconds
[0m04:33:20.822617 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m04:33:20.934993 [debug] [ThreadPool]: On list_dev_public: Close
[0m04:33:20.943668 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:20.944234 [debug] [MainThread]: On master: BEGIN
[0m04:33:20.944774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:33:20.945213 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:22.313198 [debug] [MainThread]: SQL status: BEGIN in 1.37 seconds
[0m04:33:22.314297 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:22.315310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:33:22.469835 [debug] [MainThread]: SQL status: SELECT in 0.15 seconds
[0m04:33:22.471187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eff512730>]}
[0m04:33:22.471824 [debug] [MainThread]: On master: ROLLBACK
[0m04:33:22.587158 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:22.588479 [debug] [MainThread]: On master: BEGIN
[0m04:33:22.819063 [debug] [MainThread]: SQL status: BEGIN in 0.23 seconds
[0m04:33:22.819806 [debug] [MainThread]: On master: COMMIT
[0m04:33:22.820387 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:22.820853 [debug] [MainThread]: On master: COMMIT
[0m04:33:22.936785 [debug] [MainThread]: SQL status: COMMIT in 0.12 seconds
[0m04:33:22.937798 [debug] [MainThread]: On master: Close
[0m04:33:22.939776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:33:22.940936 [info ] [MainThread]: 
[0m04:33:22.948461 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_first_dbt_model
[0m04:33:22.949103 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m04:33:22.950081 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:22.950502 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m04:33:22.950900 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_first_dbt_model
[0m04:33:22.954800 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m04:33:22.964647 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:22.965324 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m04:33:23.002886 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m04:33:23.008719 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:23.008911 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:33:23.009108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:23.009290 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:24.443506 [debug] [Thread-1  ]: SQL status: BEGIN in 1.43 seconds
[0m04:33:24.444588 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.445370 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:33:24.636691 [debug] [Thread-1  ]: SQL status: SELECT in 0.19 seconds
[0m04:33:24.647085 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.648089 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:33:24.773990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:33:24.779537 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.780191 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:33:24.906236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.13 seconds
[0m04:33:24.931870 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:24.932548 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:24.933312 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:25.138161 [debug] [Thread-1  ]: SQL status: COMMIT in 0.2 seconds
[0m04:33:25.139491 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.140279 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:33:25.266645 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:33:25.275520 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.276386 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m04:33:25.406477 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.13 seconds
[0m04:33:25.409097 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:25.410161 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.411066 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m04:33:25.569670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:33:25.570824 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m04:33:25.571754 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m04:33:25.698355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.13 seconds
[0m04:33:25.700407 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:25.701781 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m04:33:25.858664 [debug] [Thread-1  ]: On model.analytics_dbt.my_first_dbt_model: Close
[0m04:33:25.861022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efc4108e0>]}
[0m04:33:25.862356 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT[0m in 2.91s]
[0m04:33:25.863647 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m04:33:25.864429 [debug] [Thread-1  ]: Began running node model.analytics_dbt.vw_sales
[0m04:33:25.865505 [info ] [Thread-1  ]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m04:33:25.866819 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:25.867510 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.vw_sales
[0m04:33:25.868095 [debug] [Thread-1  ]: Compiling model.analytics_dbt.vw_sales
[0m04:33:25.870415 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m04:33:25.882185 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:25.882680 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.vw_sales
[0m04:33:25.903573 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m04:33:25.916606 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:25.916976 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:33:25.917378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:25.917658 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:27.129507 [debug] [Thread-1  ]: SQL status: BEGIN in 1.21 seconds
[0m04:33:27.130591 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.131677 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as(
    select
         *
    from sales
),

renamed as(
    SELECT
        SALESID AS ID_VENDA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        TO_CHAR(SALETIME, 'dd/mm/yyyy HH24:MI:SS') as DATA_HORA_VENDA,
        cast(saletime as date) as DATA_VENDA,
        TO_CHAR(SALETIME, 'HH24:MI:SS') as HORA_VENDA
    FROM source_sales
)

SELECT
    *
from renamed
  ) ;

[0m04:33:27.250971 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.12 seconds
[0m04:33:27.257204 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.258090 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales" rename to "vw_sales__dbt_backup"
[0m04:33:27.371602 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:33:27.374456 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.374794 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m04:33:27.487344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.11 seconds
[0m04:33:27.488993 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:27.489616 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.490100 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:27.631821 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:33:27.633462 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.634312 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:33:27.749892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:33:27.754560 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.755346 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m04:33:27.871837 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.12 seconds
[0m04:33:27.873311 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:27.873977 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:27.874599 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: COMMIT
[0m04:33:28.012433 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m04:33:28.013805 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m04:33:28.014766 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: BEGIN
[0m04:33:28.128928 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m04:33:28.130864 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:28.131918 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m04:33:28.311820 [debug] [Thread-1  ]: On model.analytics_dbt.vw_sales: Close
[0m04:33:28.314405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efc379af0>]}
[0m04:33:28.315955 [info ] [Thread-1  ]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mCREATE VIEW[0m in 2.45s]
[0m04:33:28.317392 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.vw_sales
[0m04:33:28.318585 [debug] [Thread-1  ]: Began running node model.analytics_dbt.my_second_dbt_model
[0m04:33:28.320093 [info ] [Thread-1  ]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m04:33:28.322020 [debug] [Thread-1  ]: Acquiring new redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.322834 [debug] [Thread-1  ]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m04:33:28.323524 [debug] [Thread-1  ]: Compiling model.analytics_dbt.my_second_dbt_model
[0m04:33:28.327470 [debug] [Thread-1  ]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.336881 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:28.337339 [debug] [Thread-1  ]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m04:33:28.341847 [debug] [Thread-1  ]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.352646 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:28.353077 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:33:28.353396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:33:28.353649 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:29.744608 [debug] [Thread-1  ]: SQL status: BEGIN in 1.39 seconds
[0m04:33:29.745908 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:29.746855 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;

[0m04:33:29.949329 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.2 seconds
[0m04:33:29.954825 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:29.955416 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:33:30.076490 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.12 seconds
[0m04:33:30.079391 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.080006 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.080617 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.237673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.16 seconds
[0m04:33:30.238654 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.239239 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:33:30.360384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:33:30.364649 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.365466 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m04:33:30.563773 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.2 seconds
[0m04:33:30.565487 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.566180 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.566740 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m04:33:30.714605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.15 seconds
[0m04:33:30.715683 [debug] [Thread-1  ]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m04:33:30.716548 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m04:33:30.838889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.12 seconds
[0m04:33:30.840693 [debug] [Thread-1  ]: finished collecting timing info
[0m04:33:30.841711 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m04:33:30.975438 [debug] [Thread-1  ]: On model.analytics_dbt.my_second_dbt_model: Close
[0m04:33:30.976685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be5e778-efbd-4119-998d-aeac863f3f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc769d0>]}
[0m04:33:30.977457 [info ] [Thread-1  ]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.66s]
[0m04:33:30.978099 [debug] [Thread-1  ]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m04:33:30.980169 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m04:33:30.980645 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:30.981064 [debug] [MainThread]: On master: BEGIN
[0m04:33:30.981475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:33:30.982022 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m04:33:32.052168 [debug] [MainThread]: SQL status: BEGIN in 1.07 seconds
[0m04:33:32.053323 [debug] [MainThread]: On master: COMMIT
[0m04:33:32.054070 [debug] [MainThread]: Using redshift connection "master"
[0m04:33:32.054684 [debug] [MainThread]: On master: COMMIT
[0m04:33:32.166128 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
[0m04:33:32.167442 [debug] [MainThread]: On master: Close
[0m04:33:32.169823 [info ] [MainThread]: 
[0m04:33:32.170960 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.13 seconds (14.13s).
[0m04:33:32.172182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:33:32.172973 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m04:33:32.199550 [info ] [MainThread]: 
[0m04:33:32.200494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:33:32.201001 [info ] [MainThread]: 
[0m04:33:32.201423 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:33:32.201935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc88d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc88100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2efcc81f40>]}
[0m04:33:32.202429 [debug] [MainThread]: Flushing usage events
